import{g as e,i as a,f as l,k as t,U as o,ge as r,q as n,aW as s,D as i,F as u,E as c,ay as d,gf as h,Z as v,$ as b,cC as f,gg as p,n as m,p as g,c as y,o as k,a as _,J as w,L as x,K as C,gh as K,gi as V,dE as S,gj as E,a5 as L,a6 as A,ak as D,r as R,v as $,G as B,Y as M,H,S as O,b as P,am as T,aT as W,a0 as j,a1 as q}from"./pxHhHUe5.js";const F=e({modelValue:{type:t(String),default:void 0},border:{type:Boolean,default:!0},showAlpha:Boolean,colorFormat:String,disabled:Boolean,predefine:{type:t(Array)},validateEvent:{type:Boolean,default:!0}}),z={[o]:e=>a(e)||l(e)},U=Symbol("colorCommonPickerKey"),Y=Symbol("colorPickerPanelContextKey"),X=e({color:{type:t(Object),required:!0},vertical:Boolean,disabled:Boolean}),G=X;let I=!1;function J(e,a){if(!r)return;const l=function(e){var l;null==(l=a.drag)||l.call(a,e)},t=function(e){var o;document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",l),document.removeEventListener("touchend",t),document.onselectstart=null,document.ondragstart=null,I=!1,null==(o=a.end)||o.call(a,e)},o=function(e){var o;I||(document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",l),document.addEventListener("mouseup",t),document.addEventListener("touchmove",l),document.addEventListener("touchend",t),I=!0,null==(o=a.start)||o.call(a,e))};e.addEventListener("mousedown",o),e.addEventListener("touchstart",o,{passive:!1})}const Z=(e,{key:a,minValue:l,maxValue:t})=>{const o=f(),r=d(),n=d(),s=c(()=>e.color.get(a));function i(l){if(!n.value||!r.value||e.disabled)return;const s=o.vnode.el.getBoundingClientRect(),{clientX:i,clientY:u}=p(l);let c;if(e.vertical){let e=u-s.top;e=Math.max(r.value.offsetHeight/2,e),e=Math.min(e,s.height-r.value.offsetHeight/2),c=Math.round((e-r.value.offsetHeight/2)/(s.height-r.value.offsetHeight)*t)}else{let e=i-s.left;e=Math.max(r.value.offsetWidth/2,e),e=Math.min(e,s.width-r.value.offsetWidth/2),c=Math.round((e-r.value.offsetWidth/2)/(s.width-r.value.offsetWidth)*t)}e.color.set(a,c)}function u(o){let r=s.value+o;r=r<l?l:r>t?t:r,e.color.set(a,r)}return{thumb:r,bar:n,currentValue:s,handleDrag:i,handleClick:function(a){var l;if(e.disabled)return;a.target!==r.value&&i(a),null==(l=r.value)||l.focus()},handleKeydown:function(o){if(e.disabled)return;const{shiftKey:r}=o,n=v(o),s=r?10:1,i="hue"===a?-1:1;let c=!0;switch(n){case b.left:case b.down:u(-s*i);break;case b.right:case b.up:u(s*i);break;case b.home:e.color.set(a,"hue"===a?t:l);break;case b.end:e.color.set(a,"hue"===a?l:t);break;case b.pageDown:u(-4*i);break;case b.pageUp:u(4*i);break;default:c=!1}c&&o.preventDefault()}}},N=(e,{namespace:a,maxValue:l,bar:t,thumb:o,currentValue:r,handleDrag:d,getBackground:v})=>{const b=f(),p=n(a),m=u(0),g=u(0),y=u();function k(){m.value=function(){if(!o.value)return 0;if(e.vertical)return 0;const a=b.vnode.el,t=r.value;return a?Math.round(t*(a.offsetWidth-o.value.offsetWidth/2)/l):0}(),g.value=function(){if(!o.value)return 0;const a=b.vnode.el;if(!e.vertical)return 0;const t=r.value;return a?Math.round(t*(a.offsetHeight-o.value.offsetHeight/2)/l):0}(),y.value=null==v?void 0:v()}s(()=>{if(!t.value||!o.value)return;const e={drag:e=>{d(e)},end:e=>{d(e)}};J(t.value,e),J(o.value,e),k()}),i(r,()=>k()),i(()=>e.color.value,()=>k());const _=c(()=>[p.b(),p.is("vertical",e.vertical),p.is("disabled",e.disabled)]),w=c(()=>p.e("bar")),x=c(()=>p.e("thumb"));return{rootKls:_,barKls:w,barStyle:c(()=>({background:y.value})),thumbKls:x,thumbStyle:c(()=>({left:h(m.value),top:h(g.value)})),thumbLeft:m,thumbTop:g,update:k}},Q=["aria-label","aria-valuenow","aria-valuetext","aria-orientation","tabindex","aria-disabled"];var ee=m({name:"ElColorAlphaSlider",__name:"alpha-slider",props:X,setup(e,{expose:a}){const l=e,{currentValue:t,bar:o,thumb:r,handleDrag:n,handleClick:s,handleKeydown:i}=Z(l,{key:"alpha",minValue:0,maxValue:100}),{rootKls:u,barKls:d,barStyle:h,thumbKls:v,thumbStyle:b,update:f}=N(l,{namespace:"color-alpha-slider",maxValue:100,currentValue:t,bar:o,thumb:r,handleDrag:n,getBackground:function(){if(l.color&&l.color.value){const{r:e,g:a,b:t}=l.color.toRgb();return`linear-gradient(to right, rgba(${e}, ${a}, ${t}, 0) 0%, rgba(${e}, ${a}, ${t}, 1) 100%)`}return""}}),{t:p}=g(),m=c(()=>p("el.colorpicker.alphaLabel")),K=c(()=>p("el.colorpicker.alphaDescription",{alpha:t.value,color:l.color.value}));return a({update:f,bar:o,thumb:r}),(a,l)=>(k(),y("div",{class:C(w(u))},[_("div",{ref_key:"bar",ref:o,class:C(w(d)),style:x(w(h)),onClick:l[0]||(l[0]=(...e)=>w(s)&&w(s)(...e))},null,6),_("div",{ref_key:"thumb",ref:r,class:C(w(v)),style:x(w(b)),"aria-label":m.value,"aria-valuenow":w(t),"aria-valuetext":K.value,"aria-orientation":e.vertical?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,role:"slider",tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,onKeydown:l[1]||(l[1]=(...e)=>w(i)&&w(i)(...e))},null,46,Q)],2))}});const ae=["aria-label","aria-valuenow","aria-valuetext","aria-orientation","tabindex","aria-disabled"];var le=m({name:"ElColorHueSlider",__name:"hue-slider",props:G,setup(e,{expose:a}){const l=e,{currentValue:t,bar:o,thumb:r,handleDrag:n,handleClick:s,handleKeydown:i}=Z(l,{key:"hue",minValue:0,maxValue:360}),{rootKls:u,barKls:d,thumbKls:h,thumbStyle:v,thumbTop:b,update:f}=N(l,{namespace:"color-hue-slider",maxValue:360,currentValue:t,bar:o,thumb:r,handleDrag:n}),{t:p}=g(),m=c(()=>p("el.colorpicker.hueLabel")),K=c(()=>p("el.colorpicker.hueDescription",{hue:t.value,color:l.color.value}));return a({bar:o,thumb:r,thumbTop:b,update:f}),(a,l)=>(k(),y("div",{class:C(w(u))},[_("div",{ref_key:"bar",ref:o,class:C(w(d)),onClick:l[0]||(l[0]=(...e)=>w(s)&&w(s)(...e))},null,2),_("div",{ref_key:"thumb",ref:r,class:C(w(h)),style:x(w(v)),"aria-label":m.value,"aria-valuenow":w(t),"aria-valuetext":K.value,"aria-orientation":e.vertical?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":360,role:"slider",tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,onKeydown:l[1]||(l[1]=(...e)=>w(i)&&w(i)(...e))},null,46,ae)],2))}});const te=e({colors:{type:t(Array),required:!0},color:{type:t(Object),required:!0},enableAlpha:{type:Boolean,required:!0},disabled:Boolean});var oe=Object.defineProperty,re=(e,a,l)=>((e,a,l)=>a in e?oe(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l)(e,"symbol"!=typeof a?a+"":a,l);class ne{constructor(e={}){re(this,"_hue",0),re(this,"_saturation",100),re(this,"_value",100),re(this,"_alpha",100),re(this,"_tiny",new K),re(this,"_isValid",!1),re(this,"enableAlpha",!1),re(this,"format",""),re(this,"value",""),re(this,"selected");for(const a in e)V(e,a)&&(this[a]=e[a]);e.value?this.fromString(e.value):this.doOnChange()}set(e,a){if(1!==arguments.length||"object"!=typeof e)this[`_${e}`]=a,this._isValid=!0,this.doOnChange();else for(const l in e)V(e,l)&&this.set(l,e[l])}get(e){return["hue","saturation","value","alpha"].includes(e)?Math.round(this[`_${e}`]):this[`_${e}`]}toRgb(){return this._isValid?this._tiny.toRgb():{r:255,g:255,b:255,a:0}}fromString(e){const a=new K(e);if(this._isValid=a.isValid,a.isValid){const{h:e,s:l,v:t,a:o}=a.toHsv();this._hue=e,this._saturation=100*l,this._value=100*t,this._alpha=100*o}else this._hue=0,this._saturation=100,this._value=100,this._alpha=100;this.doOnChange()}clear(){this._isValid=!1,this.value="",this._hue=0,this._saturation=100,this._value=100,this._alpha=100}compare(e){const a=new K({h:e._hue,s:e._saturation/100,v:e._value/100,a:e._alpha/100});return this._tiny.equals(a)}doOnChange(){const{_hue:e,_saturation:a,_value:l,_alpha:t,format:o,enableAlpha:r}=this;let n=o||(r?"rgb":"hex");"hex"===o&&r&&(n="hex8"),this._tiny=new K({h:e,s:a/100,v:l/100,a:t/100}),this.value=this._isValid?this._tiny.toString(n):""}}const se=["disabled","aria-label","onClick"];var ie=m({name:"ElColorPredefine",__name:"predefine",props:te,setup(e){const a=e,{rgbaColors:l,handleSelect:t}=(e=>{const{currentColor:a}=S(Y),l=u(t(e.colors,e.color));function t(a,l){return a.map(a=>{const t=new ne({value:a,enableAlpha:e.enableAlpha});return t.selected=t.compare(l),t})}return i(()=>a.value,a=>{const t=new ne({value:a,enableAlpha:e.enableAlpha});l.value.forEach(e=>{e.selected=t.compare(e)})}),E(()=>{l.value=t(e.colors,e.color)}),{rgbaColors:l,handleSelect:function(a){e.color.fromString(e.colors[a])}}})(a),{rootKls:o,colorsKls:r,colorSelectorKls:s}=(e=>{const a=n("color-predefine");return{rootKls:c(()=>[a.b(),a.is("disabled",e.disabled)]),colorsKls:c(()=>a.e("colors")),colorSelectorKls:function(e){return[a.e("color-selector"),a.is("alpha",e.get("alpha")<100),{selected:e.selected}]}}})(a),{t:d}=g();return(a,n)=>(k(),y("div",{class:C(w(o))},[_("div",{class:C(w(r))},[(k(!0),y(L,null,A(w(l),(a,l)=>{return k(),y("button",{key:e.colors[l],type:"button",disabled:e.disabled,"aria-label":(o=a.value,d("el.colorpicker.predefineDescription",{value:o})),class:C(w(s)(a)),onClick:e=>w(t)(l)},[_("div",{style:x({backgroundColor:a.value})},null,4)],10,se);var o}),128))],2)],2))}});const ue=e({color:{type:t(Object),required:!0},disabled:Boolean}),ce=["tabindex","aria-disabled","aria-label","aria-valuenow","aria-valuetext"];var de=m({name:"ElSvPanel",__name:"sv-panel",props:ue,setup(e,{expose:a}){const l=e,{cursorRef:t,cursorTop:o,cursorLeft:r,background:d,saturation:m,brightness:K,handleClick:V,handleDrag:S,handleKeydown:E}=(e=>{const a=f(),l=u(),t=u(0),o=u(0),r=u("hsl(0, 100%, 50%)"),n=c(()=>e.color.get("saturation")),s=c(()=>e.color.get("value")),i=c(()=>e.color.get("hue"));function d(l){if(e.disabled)return;const r=a.vnode.el.getBoundingClientRect(),{clientX:n,clientY:s}=p(l);let i=n-r.left,u=s-r.top;i=Math.max(0,i),i=Math.min(i,r.width),u=Math.max(0,u),u=Math.min(u,r.height),o.value=i,t.value=u,e.color.set({saturation:i/r.width*100,value:100-u/r.height*100})}function h(a){let l=n.value+a;l=l<0?0:l>100?100:l,e.color.set("saturation",l)}function m(a){let l=s.value+a;l=l<0?0:l>100?100:l,e.color.set("value",l)}return{cursorRef:l,cursorTop:t,cursorLeft:o,background:r,saturation:n,brightness:s,hue:i,handleClick:function(a){var t;e.disabled||(a.target!==l.value&&d(a),null==(t=l.value)||t.focus({preventScroll:!0}))},handleDrag:d,handleKeydown:function(a){if(e.disabled)return;const{shiftKey:l}=a,t=l?10:1;let o=!0;switch(v(a)){case b.left:h(-t);break;case b.right:h(t);break;case b.up:m(t);break;case b.down:m(-t);break;default:o=!1}o&&a.preventDefault()}}})(l),{rootKls:L,cursorKls:A,rootStyle:D,cursorStyle:R,update:$}=((e,{cursorTop:a,cursorLeft:l,background:t,handleDrag:o})=>{const r=f(),u=n("color-svpanel");function d(){const o=e.color.get("saturation"),n=e.color.get("value"),s=r.vnode.el,{clientWidth:i,clientHeight:u}=s;l.value=o*i/100,a.value=(100-n)*u/100,t.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}return s(()=>{J(r.vnode.el,{drag:e=>{o(e)},end:e=>{o(e)}}),d()}),i([()=>e.color.get("hue"),()=>e.color.get("value"),()=>e.color.value],()=>d()),{rootKls:c(()=>u.b()),cursorKls:c(()=>u.e("cursor")),rootStyle:c(()=>({backgroundColor:t.value})),cursorStyle:c(()=>({top:h(a.value),left:h(l.value)})),update:d}})(l,{cursorTop:o,cursorLeft:r,background:d,handleDrag:S}),{t:B}=g(),M=c(()=>B("el.colorpicker.svLabel")),H=c(()=>B("el.colorpicker.svDescription",{saturation:m.value,brightness:K.value,color:l.color.value}));return a({update:$}),(a,l)=>(k(),y("div",{class:C(w(L)),style:x(w(D)),onClick:l[1]||(l[1]=(...e)=>w(V)&&w(V)(...e))},[_("div",{ref_key:"cursorRef",ref:t,class:C(w(A)),style:x(w(R)),tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,role:"slider","aria-valuemin":"0,0","aria-valuemax":"100,100","aria-label":M.value,"aria-valuenow":`${w(m)},${w(K)}`,"aria-valuetext":H.value,onKeydown:l[0]||(l[0]=(...e)=>w(E)&&w(E)(...e))},null,46,ce)],6))}});const he=(e,a)=>{const l=D(new ne({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue}));return i(()=>[e.colorFormat,e.showAlpha],()=>{l.enableAlpha=e.showAlpha,l.format=e.colorFormat||l.format,l.doOnChange(),a(o,l.value)}),{color:l}};const ve=q(m({name:"ElColorPickerPanel",__name:"color-picker-panel",props:F,emits:z,setup(e,{expose:a,emit:l}){const t=e,r=l,d=n("color-picker-panel"),{formItem:h}=R(),v=$(),b=u(),f=u(),p=u(),m=u(),g=u(""),{color:x}=S(U,()=>he(t,r),!0);function K(){x.fromString(g.value),x.value!==g.value&&(g.value=x.value)}function V(){var e;t.validateEvent&&(null==(e=null==h?void 0:h.validate)||e.call(h,"blur").catch(e=>M()))}function E(){var e,a,l;null==(e=b.value)||e.update(),null==(a=f.value)||a.update(),null==(l=p.value)||l.update()}return s(()=>{t.modelValue&&(g.value=x.value),B(E)}),i(()=>t.modelValue,e=>{e!==x.value&&(e?x.fromString(e):x.clear())}),i(()=>x.value,e=>{r(o,e),g.value=e,t.validateEvent&&(null==h||h.validate("change").catch(e=>M()))}),j(Y,{currentColor:c(()=>x.value)}),a({color:x,inputRef:m,update:E}),(a,l)=>(k(),y("div",{class:C([w(d).b(),w(d).is("disabled",w(v)),w(d).is("border",e.border)]),onFocusout:V},[_("div",{class:C(w(d).e("wrapper"))},[P(le,{ref_key:"hueRef",ref:b,class:"hue-slider",color:w(x),vertical:"",disabled:w(v)},null,8,["color","disabled"]),P(de,{ref_key:"svRef",ref:f,color:w(x),disabled:w(v)},null,8,["color","disabled"])],2),e.showAlpha?(k(),H(ee,{key:0,ref_key:"alphaRef",ref:p,color:w(x),disabled:w(v)},null,8,["color","disabled"])):O("v-if",!0),e.predefine?(k(),H(ie,{key:1,ref:"predefine","enable-alpha":e.showAlpha,color:w(x),colors:e.predefine,disabled:w(v)},null,8,["enable-alpha","color","colors","disabled"])):O("v-if",!0),_("div",{class:C(w(d).e("footer"))},[P(w(W),{ref_key:"inputRef",ref:m,modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=e=>g.value=e),"validate-event":!1,size:"small",disabled:w(v),onChange:K},null,8,["modelValue","disabled"]),T(a.$slots,"footer")],2)],34))}}));export{ne as C,ve as E,U as R,F as c,he as u};

import{n as e,aA as a,a3 as l,a2 as r,go as t,av as i,D as s,E as o,ay as n,F as c,b$ as d,fR as u,fS as p,n_ as m,aR as f,a7 as g,M as v,fm as b,c as y,o as x,b as h,a as P,w as N,H as k,S as w,J as T,t as _,d as I,a8 as S,a5 as L,K as O,aa as D,aq as E,T as C,al as Y,ak as M,ax as A,qs as j}from"./pxHhHUe5.js";import{E as R,a as $}from"./DlhmlHT6.js";import"./xG3n2otq.js";import"./uG3PizZo.js";import"./DU6RBO19.js";const z=["infinite-scroll-disabled"],H={class:"text-12px"},B={key:1},F={class:"text-14px"},q={key:0,class:"color-[--down-color]"},G={key:1,class:"color-[--up-color]"},U={key:2},J={key:0,class:"color-[--up-color]"},K={key:1},V={key:2,class:"color-[--down-color]"},X={key:3},Z={class:"flex items-center justify-end gap-4px"},Q={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},W={key:0},ee=e({__name:"currentOrder",props:{searchParams:{}},setup(e){const ee=a(),{mode:ae}=l(r()),le=t(),{t:re}=i(),te=e,{isCancelOrder:ie,order:se}=l(t()),oe=n([]),ne=c({loading:!1,finished:!1,error:!1}),ce=c(""),de={LAST_PRICE:re("latestPrice"),INDEX_PRICE:re("indexPrice")},ue=o(()=>{var e,a,l;const r=(null==(l=null==(a=null==(e=le.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,(e,a)=>(e[a.contractId]=a.contractName,e),{}))||{};return r.ALL=re("all"),r}),pe=async()=>{if("perp-id"==ee.name)return;if(ne.value.loading||ne.value.finished)return;const e={filterStatusList:"CANCELING,OPEN,PENDING",...te.searchParams};ce.value&&(e.offsetData=ce.value);try{ne.value.loading=!0;const a=await j(e);let l=a.dataList||[];ce.value&&(l=oe.value.concat(l)),a.nextPageOffsetData||(ne.value.finished=!0),ce.value=a.nextPageOffsetData,oe.value=l}catch(a){ne.value.error=!0}finally{ne.value.loading=!1}},me=M({}),fe=o(()=>{var e,a;const l=null==(e=se.value)?void 0:e.toSorted((e,a)=>Number(a.createdTime)-Number(e.createdTime));return(null==(a=null==l?void 0:l.map)?void 0:a.call(l,e=>{const a="SELL"===e.side,l=e.type.includes("PROFIT");let r="";return r=a?l?"≥":"≤":l?"≤":"≥",{...e,triggerSign:r}}))||[]});return s(()=>te.searchParams,e=>{"perp-id"===ee.name?(null==e?void 0:e.filterContractIdList)?oe.value=(null==fe?void 0:fe.value.filter(a=>a.contractId==(null==e?void 0:e.filterContractIdList)))||[]:oe.value=null==fe?void 0:fe.value:(ce.value="",oe.value=[],ne.value.finished=!1,ne.value.error=!1,ne.value.loading=!1,pe())},{immediate:!0}),s(()=>ie.value,e=>{e&&d.confirm(re("cancelAllOrderTips"),re("cancelAllOrder"),{type:"warning",icon:u(p),confirmButtonText:re("confirm"),cancelButtonText:re("cancel"),customClass:`${ae.value} delete_confirm`}).then(()=>{var e;const a=null==(e=oe.value)?void 0:e.map(e=>e.id);m(a).then(()=>{f.success(re("cancelledOrderSuccessfully"))}).finally(()=>{ie.value=!1})}).catch(e=>{})}),(e,a)=>{const l=A,r=R,t=D,i=C,s=$,o=g("copy"),n=b;return v((x(),y("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":T(ne).loading||T(ne).finished||T(ne).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[h(s,{data:T(oe),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:N(()=>{var a;return[T(ne).loading||0!==(null==(a=T(oe))?void 0:a.length)?(x(),y("span",B)):(x(),k(l,{key:0,class:"pt-[40px]"},{default:N(()=>[P("span",H,_(e.$t("emptyNoData")),1)]),_:1}))]}),default:N(()=>[h(r,{label:T(re)("markets1"),prop:"contractId"},{default:N(({row:e})=>[P("span",F,_(T(ue)[e.contractId]),1)]),_:1},8,["label"]),"perp-id"==T(ee).name?(x(),k(r,{key:0,label:T(re)("type"),width:100},{default:N(({row:a})=>[a.type.includes("STOP")?(x(),y("span",q,_(e.$t("stopLoss")),1)):a.type.includes("PROFIT")?(x(),y("span",G,_(e.$t("takeProfit")),1)):a.type.includes("LIMIT")?(x(),y("span",U,_(e.$t("limit")),1)):w("",!0)]),_:1},8,["label"])):w("",!0),h(r,{width:100,label:T(re)("price"),prop:"price"},{default:N(({row:a})=>[I(_(a.type.includes("LIMIT")?("formatNumber"in e?e.formatNumber:T(S))(a.price,{decimals:10,limit:20}):T(re)("market")),1)]),_:1},8,["label"]),"perp-id"==T(ee).name?(x(),k(r,{key:1,align:"right",label:T(re)("triggerPrice"),prop:"triggerPrice"},{default:N(({row:a})=>[""!==a.triggerPrice&&a.triggerPrice>0?(x(),y(L,{key:0},[I(_(a.triggerSign)+_(("formatNumber"in e?e.formatNumber:T(S))(a.triggerPrice,{limit:20,decimals:10}))+" "+_(de[a.triggerPriceType]),1)],64)):(x(),y(L,{key:1},[I(" -- ")],64))]),_:1},8,["label"])):w("",!0),h(r,{width:150,align:"right",label:T(re)("tradeVolume"),prop:"contractSize"},{default:N(({row:a})=>[I(_(("formatNumber"in e?e.formatNumber:T(S))(a.cumMatchSize,3))+"/"+_(("formatNumber"in e?e.formatNumber:T(S))(a.l2Size,3)),1)]),_:1},8,["label"]),h(r,{width:100,align:"right",label:T(re)("tradeType"),prop:"tradeType"},{default:N(({row:e})=>[P("span",{class:O("BUY"===e.side?"color-[--up-color]":"color-[--down-color]")},_("BUY"===e.side?T(re)("buy"):T(re)("sell")),3)]),_:1},8,["label"]),h(r,{align:"right",label:T(re)("takeProfitStopLoss"),prop:"takeProfitStopLoss"},{default:N(({row:l})=>[l.openTp.triggerPrice?(x(),y("span",J,_(("formatNumber"in e?e.formatNumber:T(S))(l.openTp.triggerPrice,{limit:20,decimals:10})),1)):(x(),y("span",K,"--")),a[0]||(a[0]=P("span",{class:"color-[--icon-color] mx-4px"},"/",-1)),l.openSl.triggerPrice?(x(),y("span",V,_(("formatNumber"in e?e.formatNumber:T(S))(l.openSl.triggerPrice,{limit:20,decimals:10})),1)):(x(),y("span",X,"--"))]),_:1},8,["label"]),h(r,{align:"right",label:T(re)("orderId"),prop:"id"},{default:N(({row:e})=>{var a,l;return[P("div",Z,[I(_((null==(a=e.id)?void 0:a.slice(0,4))+"..."+(null==(l=e.id)?void 0:l.slice(-4))),1),v(h(t,{name:"bxs:copy",class:"color-[#5A5E64]"},null,512),[[o,e.id]])])]}),_:1},8,["label"]),h(r,{align:"right",label:T(re)("orderTime"),prop:"createdTime"},{default:N(({row:e})=>[I(_(T(E)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),h(r,{align:"right",label:T(re)("validityPeriod"),prop:"l2ExpireTime"},{default:N(({row:e})=>[I(_(T(E)(Number(e.expireTime)).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),h(r,{align:"right",label:T(re)("action"),prop:"operate"},{default:N(({row:e})=>[h(i,{size:"small",style:{"--el-button-active-border-color":"transparent"},loading:T(me)[e.id],onClick:Y(a=>(async e=>{me[e[0]]=!0,await m(e).finally(()=>{me[e[0]]=!1}),pe(),f.success(re("cancelledOrderSuccessfully"))})([e.id]),["stop"])},{default:N(()=>[I(_(T(re)("cancel")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),P("div",Q,[T(ne).loading&&T(ce)?(x(),y("span",W,_(T(re)("loading")),1)):w("",!0)])],8,z)),[[n,pe]])}}});export{ee as default};

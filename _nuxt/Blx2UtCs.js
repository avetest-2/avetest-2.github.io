import{n as e,au as a,av as l,go as t,D as s,F as r,ay as i,M as n,fm as o,c as d,o as c,b as m,a as f,w as u,J as p,t as b,E as x,d as g,a8 as h,K as v,cQ as y,dl as w,aQ as N,aa as F,aq as _,H as P,ax as M,S as j,qv as O}from"./pxHhHUe5.js";import{E as D,a as C}from"./DlhmlHT6.js";import"./xG3n2otq.js";import"./uG3PizZo.js";import"./DU6RBO19.js";const S=["infinite-scroll-disabled"],T={class:"text-12px"},Y={key:1},k={class:"text-14px"},V={class:"flex items-center justify-end gap-4px"},z={class:"color-[--main-text] font-bold mb-8px"},I={class:"flex items-center justify-between text-12px mb-16px"},L={class:"color-[--third-text]"},H={class:"flex items-center justify-between text-12px mb-16px"},Q={class:"color-[--third-text]"},U={class:"flex items-center justify-between text-12px mb-16px"},q={class:"color-[--third-text]"},B={class:"flex items-center justify-between text-12px mb-16px"},E={class:"color-[--third-text]"},A={class:"flex flex-col text-12px mb-16px gap-4px"},J={class:"color-[--third-text]"},K={class:"flex flex-col text-12px"},Z={class:"color-[--third-text]"},$={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},G={key:0},R=e({__name:"closePnl",props:{searchParams:{}},setup(e){const R=a(),{t:W}=l(),X=e,ee=t(),ae=i([]),le=r({loading:!1,finished:!1,error:!1}),te=r(""),se=x(()=>{var e,a,l;const t=(null==(l=null==(a=null==(e=ee.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,(e,a)=>(e[a.contractId]=a.contractName,e),{}))||{};return t.ALL=W("all"),t}),re=e=>h(e.realizePnl-e.deltaOpenFee),ie=async()=>{if(le.value.loading||le.value.finished)return;const e={filterCloseOnly:!0,...X.searchParams};te.value&&(e.offsetData=te.value);try{le.value.loading=!0;const a=await O(e);let l=a.dataList||[];te.value&&(l=ae.value.concat(l)),a.nextPageOffsetData||(le.value.finished=!0),te.value=a.nextPageOffsetData,ae.value=l}catch(a){le.value.error=!0}finally{le.value.loading=!1}};return R.address&&ie(),s(()=>[X.searchParams,R.address],()=>{te.value="",ae.value=[],le.value.finished=!1,le.value.error=!1,le.value.loading=!1,ie()}),(e,a)=>{const l=M,t=D,s=F,r=N,i=C,x=o;return n((c(),d("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":p(le).loading||p(le).finished||p(le).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[m(i,{fit:"",data:p(ae),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:u(()=>{var a;return[p(le).loading||0!==(null==(a=p(ae))?void 0:a.length)?(c(),d("span",Y)):(c(),P(l,{key:0,class:"pt-[40px]"},{default:u(()=>[f("span",T,b(e.$t("emptyNoData")),1)]),_:1}))]}),default:u(()=>[m(t,{label:p(W)("markets1"),prop:"contractId"},{default:u(({row:e})=>[f("span",k,b(p(se)[e.contractId]),1)]),_:1},8,["label"]),m(t,{width:120,label:p(W)("Qty")},{default:u(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:p(h))(a.beforeOpenSize))+" "+b(p(se)[a.contractId].replace("USD","")),1)]),_:1},8,["label"]),m(t,{width:150,align:"right",label:p(W)("entryPrice")},{default:u(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:p(h))(a.beforeOpenValue/a.beforeOpenSize,{limit:20,decimals:2})),1)]),_:1},8,["label"]),m(t,{width:150,align:"right",label:p(W)("exitPrice")},{default:u(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:p(h))(a.fillPrice,{limit:20,decimals:2})),1)]),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:p(W)("tradeType"),prop:"side"},{default:u(({row:e})=>[f("span",{class:v(e.type.includes("BUY")?"color-[--up-color]":"color-[--down-color]")},b(e.type.includes("BUY")?p(W)("buy"):p(W)("sell")),3)]),_:1},8,["label"]),m(t,{align:"right",label:p(W)("closePnl"),prop:"closePnl"},{default:u(({row:a})=>[f("div",V,[f("span",{class:v(("getColorClass"in e?e.getColorClass:p(y))(re(a)))},b(("addSign"in e?e.addSign:p(w))(+re(a)))+b(Math.abs(+re(a))),3),m(r,{width:200},{reference:u(()=>[m(s,{name:"custom:info"})]),default:u(()=>[f("div",null,[f("div",z,b(p(W)("closePnlDetail")),1),f("div",I,[f("span",L,b(p(W)("closeValue")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:p(h))(Math.abs(a.fillCloseValue),{limit:20})),1)]),f("div",H,[f("span",Q,b(p(W)("openValue")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:p(h))(Math.abs(a.beforeOpenValue),{limit:20})),1)]),f("div",U,[f("span",q,b(p(W)("fee")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:p(h))(Math.abs(a.fillCloseFee)+Math.abs(a.beforeOpenFee),{limit:20})),1)]),f("div",B,[f("span",E,b(p(W)("fundingFee")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:p(h))(a.deltaFundingFee,{limit:20})),1)]),f("div",A,[f("span",J,b(p(W)("long2")),1),f("span",null,b(p(W)("longPnl")),1)]),f("div",K,[f("span",Z,b(p(W)("short2")),1),f("span",null,b(p(W)("shortPnl")),1)])])]),_:2},1024)])]),_:1},8,["label"]),m(t,{align:"right",label:p(W)("openFee"),prop:"openFee"},{default:u(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:p(h))(Math.abs(a.beforeOpenFee),{limit:20})),1)]),_:1},8,["label"]),m(t,{align:"right",label:p(W)("closeFee"),prop:"closeFee"},{default:u(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:p(h))(Math.abs(a.fillCloseFee),{limit:20})),1)]),_:1},8,["label"]),m(t,{align:"right",label:p(W)("fundingFee"),prop:"fundingFee"},{default:u(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:p(h))(Math.abs(a.deltaFundingFee),{limit:20})),1)]),_:1},8,["label"]),m(t,{align:"right",label:p(W)("exitType"),prop:"exitType"},{default:u(()=>[g(b(p(W)("trades")),1)]),_:1},8,["label"]),m(t,{align:"right",label:p(W)("tradeTime"),prop:"fundingTime"},{default:u(({row:e})=>[g(b(p(_)(+e.censorTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"])]),_:1},8,["data"]),f("div",$,[p(le).loading&&p(te)?(c(),d("span",G,b(p(W)("loading")),1)):j("",!0)])],8,S)),[[x,ie]])}}});export{R as default};

import{ah as e,e5 as t,ay as n,F as a,au as r,at as o,av as l,E as i,bC as s,eb as u,ec as c,ar as d,cf as v,dF as p}from"./pxHhHUe5.js";
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f=Symbol("Comlink.proxy"),m=Symbol("Comlink.endpoint"),h=Symbol("Comlink.releaseProxy"),g=Symbol("Comlink.finalizer"),k=Symbol("Comlink.thrown"),y=e=>"object"==typeof e&&null!==e||"function"==typeof e,_=new Map([["proxy",{canHandle:e=>y(e)&&e[f],serialize(e){const{port1:t,port2:n}=new MessageChannel;return w(e,t),[n,[n]]},deserialize:e=>(e.start(),E(e))}],["throw",{canHandle:e=>y(e)&&k in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function w(e,t=globalThis,n=["*"]){t.addEventListener("message",function a(r){if(!r||!r.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,r.origin))return;const{id:o,type:l,path:i}=Object.assign({path:[]},r.data),s=(r.data.argumentList||[]).map(O);let u;try{const t=i.slice(0,-1).reduce((e,t)=>e[t],e),n=i.reduce((e,t)=>e[t],e);switch(l){case"GET":u=n;break;case"SET":t[i.slice(-1)[0]]=O(r.data.value),u=!0;break;case"APPLY":u=n.apply(t,s);break;case"CONSTRUCT":u=function(e){return Object.assign(e,{[f]:!0})}(new n(...s));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;w(e,n),u=function(e,t){return M.set(e,t),e}(t,[t])}break;case"RELEASE":u=void 0;break;default:return}}catch(c){u={value:c,[k]:0}}Promise.resolve(u).catch(e=>({value:e,[k]:0})).then(n=>{const[r,i]=N(n);t.postMessage(Object.assign(Object.assign({},r),{id:o}),i),"RELEASE"===l&&(t.removeEventListener("message",a),b(t),g in e&&"function"==typeof e[g]&&e[g]())}).catch(e=>{const[n,a]=N({value:new TypeError("Unserializable return value"),[k]:0});t.postMessage(Object.assign(Object.assign({},n),{id:o}),a)})}),t.start&&t.start()}function b(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function E(e,t){const n=new Map;return e.addEventListener("message",function(e){const{data:t}=e;if(!t||!t.id)return;const a=n.get(t.id);if(a)try{a(t)}finally{n.delete(t.id)}}),L(e,n,[],t)}function S(e){if(e)throw new Error("Proxy has been released and is not useable")}function C(e){return P(e,new Map,{type:"RELEASE"}).then(()=>{b(e)})}const R=new WeakMap,A="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(R.get(e)||0)-1;R.set(e,t),0===t&&C(e)});function L(e,t,n=[],a=function(){}){let r=!1;const o=new Proxy(a,{get(a,l){if(S(r),l===h)return()=>{!function(e){A&&A.unregister(e)}(o),C(e),t.clear(),r=!0};if("then"===l){if(0===n.length)return{then:()=>o};const a=P(e,t,{type:"GET",path:n.map(e=>e.toString())}).then(O);return a.then.bind(a)}return L(e,t,[...n,l])},set(a,o,l){S(r);const[i,s]=N(l);return P(e,t,{type:"SET",path:[...n,o].map(e=>e.toString()),value:i},s).then(O)},apply(a,o,l){S(r);const i=n[n.length-1];if(i===m)return P(e,t,{type:"ENDPOINT"}).then(O);if("bind"===i)return L(e,t,n.slice(0,-1));const[s,u]=T(l);return P(e,t,{type:"APPLY",path:n.map(e=>e.toString()),argumentList:s},u).then(O)},construct(a,o){S(r);const[l,i]=T(o);return P(e,t,{type:"CONSTRUCT",path:n.map(e=>e.toString()),argumentList:l},i).then(O)}});return function(e,t){const n=(R.get(t)||0)+1;R.set(t,n),A&&A.register(e,t,e)}(o,e),o}function T(e){const t=e.map(N);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const M=new WeakMap;function N(e){for(const[t,n]of _)if(n.canHandle(e)){const[a,r]=n.serialize(e);return[{type:"HANDLER",name:t,value:a},r]}return[{type:"RAW",value:e},M.get(e)||[]]}function O(e){switch(e.type){case"HANDLER":return _.get(e.name).deserialize(e.value);case"RAW":return e.value}}function P(e,t,n,a){return new Promise(r=>{const o=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(o,r),e.start&&e.start(),e.postMessage(Object.assign({id:o},n),a)})}function j(t,n){const{$api:a}=e();return a(`/v1api/v2/tokens/${t}/vote/support`,{method:"post",body:{user_address:n}})}function x(t,n){const{$api:a}=e();return a(`/v1api/v2/tokens/${t}/vote/against`,{method:"post",body:{user_address:n}})}function z(t,n){const{$api:a}=e();return a("/v1api/v2/tokens/contract/vote",{method:"get",query:{token_id:t,user_address:n}})}function F(t){const{$api:n}=e();return n("/v1api/v2/tokens/lp_holders",{method:"get",query:{token_id:t}})}const G=t("check",()=>{const t=a(null),r=n(!1),o=n(0),l=n(!1),i=n(0),s=n(0),u=n(0);function c(e){return(null==e?void 0:e.lock)||/lock|null|(black hole)/gi.test((null==e?void 0:e.mark)||"")}return{hasLpLock:l,progress:o,showResult:r,checkResult:t,statistics_risk_store:i,statistics_warning_store:s,statistics_unknown_store:u,getContractCheckResult:function(n,a){(function(t,n){const{$api:a}=e();return a("/v1api/v2/tokens/contract",{method:"get",query:{token_id:t,type:"token",user_address:n}})})(n,a).then(e=>{var n,a,i,s,u,d,v,p,f,m;const h=e.token_contract,g=null==(n=null==h?void 0:h.contract_data)?void 0:n.audits_info;let k=null;g&&(k=JSON.parse(g));const y=(null==(i=null==(a=null==h?void 0:h.contract_data)?void 0:a.owner_txs)?void 0:i.filter(e=>{var t;return(null==e?void 0:e.params)&&(null==(t=null==e?void 0:e.params)?void 0:t.length)>0}))||[];null!==h.contract_data&&(r.value=!0);const _=((null==(s=h.contract_data)?void 0:s.pair_holders_rank)||[]).reduce((e,t)=>{let n=0;return c(t)&&(n=Number(null==t?void 0:t.quantity)),e+n},0)/Number(null==(u=null==h?void 0:h.contract_data)?void 0:u.pair_total);l.value=(null==(d=null==h?void 0:h.contract_data)?void 0:d.is_locked)||(((null==(f=null==(p=null==(v=null==h?void 0:h.contract_data)?void 0:v.pair_holders_rank)?void 0:p.some)?void 0:f.call(p,e=>c(e)))&&_>.001)??!1),o.value=((null==(m=null==h?void 0:h.contract_data)?void 0:m.risk_score)??0)/100||0;const w={...null==h?void 0:h.contract_data,...h,audits_info:k,owner_txs:y};t.value=w})}}}),$=t("rankKline",()=>{const e=a({}),t=a(null),f=a(null),m=n([]),h=a(!1),g=a(""),k=a(""),y=a(0),_=a(0),w=a(0),b=a(!1),E=a(!1),S=r(),C=o(),{t:R}=l(),A=n(0),L=i(()=>{var e;return A.value||(null==(e=M.value)?void 0:e.current_price_usd)}),T=i(()=>C.evmAddress||S.address),M=i(()=>{var e;return null==(e=t.value)?void 0:e.token}),N=i(()=>{var e,n;return null==(n=null==(e=t.value)?void 0:e.pairs)?void 0:n[0]}),O=a(!1),P=i(()=>{var e,t;return 0==y.value?R("defaultGroup"):null==(t=null==(e=m.value)?void 0:e.find(e=>e.group_id==y.value))?void 0:t.name}),j=i(()=>{var e;return null==(e=N.value)?void 0:e.pair}),x=i(()=>{var e,t,n,a;const r=new s((null==(e=M.value)?void 0:e.total)||0).minus((null==(t=M.value)?void 0:t.lock_amount_dec)||0).minus((null==(n=M.value)?void 0:n.other_amount_dec)||0).minus((null==(a=M.value)?void 0:a.burn_amount_dec)||0);return r.lt(0)?new s(0):r}),z=i(()=>new s(L.value||0).times(x.value||0).toFixed()||"0");return{klineRow:e,tokenInfo:t,tokenInfoExtra:f,userFavoriteGroups:m,collected:h,remark:g,remark2:k,groupId:y,selectedGroup:w,token:M,pair:N,selectedToken:O,twitterType:_,currentGroup:P,editableGroup:b,editableRemark:E,pairAddress:j,tokenPrice:A,price:L,circulation:x,marketCap:z,getData:function(e){const n=e.id;u(n).then(e=>{t.value=e}),c(n).then(e=>{f.value=e}),function(e){d(e).then(e=>{_.value=e.type||0}).catch(()=>{_.value=0})}(n),T.value&&(function(e){p(e,T.value).then(e=>{h.value=!!(null==e?void 0:e.address),g.value=(null==e?void 0:e.remark)||"",k.value=(null==e?void 0:e.remark)||"",y.value=(null==e?void 0:e.group_id)||0,w.value=(null==e?void 0:e.group_id)||0}).catch(e=>{}).finally(()=>{})}(n),async function(){try{const e=await v(T.value);m.value=(e||[]).filter(e=>!!e.name&&"token"===e.type)}catch(e){}}()),G().getContractCheckResult(n,T.value)}}});const I=E(new function(e){return new Worker(""+new URL("chartState.worker-C971ScU4.js",import.meta.url).href,{name:null==e?void 0:e.name})});function D(e,t="tv_charts_storage"){async function n(){await I.setStorageKey(t)}return{loadKlineLine:async function(t){var a,r;await n();const o=e?e():"default",l=await I.getFullStorage();l[o]&&t&&(null==(a=t.load)||a.call(t,l[o]));let i=l.allStudies||[];if(i.length>0&&(null==(r=null==t?void 0:t.activeChart)?void 0:r.call(t))){const e=l[o]?500:0;setTimeout(()=>{var e;!function(e,t){const n=t.getAllStudies(),a=null==e?void 0:e.filter(e=>!n.some(t=>t.name===e)),r=null==n?void 0:n.filter(t=>!e.includes(t.name)&&"Volume"!==t.name);r.forEach(e=>{e.name.includes("Volume")||t.removeEntity(e.id)}),a.forEach(e=>{t.createStudy(e,!1,!1)})}(i,null==(e=null==t?void 0:t.activeChart)?void 0:e.call(t))},e)}},saveKlineState:function(t){var a;null==(a=null==t?void 0:t.subscribe)||a.call(t,"onAutoSaveNeeded",()=>{null==t||t.save(async t=>{await n();const a=e?e():"default";await I.saveChart(a,t)})})},removeCurrentChart:async function(){await n();const t=e?e():"default";await I.removeChart(t)},clearAllCharts:async()=>(await n(),I.clearAll())}}export{z as _,G as a,j as b,x as c,D as d,F as g,$ as u};

import{n as e,di as l,dk as t,go as a,cF as r,av as i,D as o,F as n,ak as s,a7 as c,H as d,o as u,w as p,a as m,d as v,t as x,J as g,E as b,K as f,cQ as P,bC as w,a8 as h,b as y,M as S,S as I,aP as T,T as z,cD as O,dq as k,_ as L,c as A,aq as C,aa as R,b$ as V,n_ as M,aR as F,a5 as N,al as U,bF as _,L as E,dl as Z,a6 as D,gp as X,gq as j,aW as Y,dn as J,aE as K,ay as q,ax as W,n$ as Q,o0 as B,ek as H}from"./pxHhHUe5.js";import{a as G,E as $}from"./DlhmlHT6.js";import"./xG3n2otq.js";import"./uG3PizZo.js";import{g as ee,d as le,a as te,C as ae,l as re,m as ie,n as oe,u as ne,E as se}from"./Dkz-6Ico.js";import{S as ce}from"./EKWuchHU.js";import{E as de,a as ue,b as pe}from"./B3CwgMQF.js";import{E as me}from"./BwPtREp8.js";import{E as ve}from"./B-rSTJlV.js";import{E as xe}from"./-qzEQscJ.js";const ge={class:"overflow-y-auto scrollbar-hide mx--16px px-16px"},be={class:"mb-19px flex items-center gap-8px text-14px font-bold color-[--main-text]"},fe={class:"flex items-center mb-10px"},Pe={class:"flex-1 flex flex-col gap-4px color-[--main-text]"},we={class:"color-[--third-text]"},he={class:"flex-1 flex flex-col gap-4px color-[--main-text]"},ye={class:"color-[--third-text]"},Se={class:"mb-24px text-12px color-[--yellow]"},Ie={class:"flex items-center gap-4px cursor-pointer"},Te={class:"flex items-center gap-10px mt-8px mb-16px"},ze={class:"mt-16px flex items-center gap-4px cursor-pointer"},Oe={class:"flex items-center gap-10px mt-8px mb-16px"},ke={class:"color-[--main-text]"},Le={class:"mt-16px mb-16px"},Ae={class:"mt-53px flex items-center justify-between"},Ce={class:"color-[--third-text]"},Re={class:"mt-16px mb-40px flex items-center justify-between"},Ve={class:"color-[--third-text]"},Me={class:"flex"},Fe=L(e({__name:"stopProfitLoss",props:l({row:{}},{visible:{type:Boolean},visibleModifiers:{}}),emits:["update:visible"],setup(e){const l=t(e,"visible"),L=e,A=a(),C=r(),{t:R}=i(),V=n(void 0),M=s({tpPercent:void 0,tpPercent1:void 0,slPercent:void 0,slPercent1:void 0,sizePercent:void 0}),F=s({triggerPrice:void 0,triggerPriceType:"LAST_PRICE",price:void 0,type:"TAKE_PROFIT_MARKET"}),N=s({triggerPrice:void 0,triggerPriceType:"LAST_PRICE",price:void 0,type:"STOP_MARKET"});o(l,e=>{e&&(V.value=void 0,M.tpPercent=void 0,M.tpPercent1=void 0,M.slPercent=void 0,M.slPercent1=void 0,M.sizePercent=void 0,F.triggerPrice=void 0,N.triggerPrice=void 0,F.price=void 0,N.price=void 0)});const U=b(()=>{var e,l;return(null==(e=L.row)?void 0:e.openSize)&&new w((null==(l=L.row)?void 0:l.openSize)||"0").gt(0)}),_=b(()=>{var e,l,t;const a=(null==(t=null==(l=null==(e=A.metadata)?void 0:e.contractList)?void 0:l.reduce)?void 0:t.call(l,(e,l)=>(e[l.contractId]=l.contractName,e),{}))||{};return a.ALL=R("all"),a}),E=b(()=>{var e;return ee((null==(e=L.row)?void 0:e.contractId)||"")}),Z=b(()=>{var e;return le((null==(e=L.row)?void 0:e.contractId)||"")}),D=b(()=>{var e;return te((null==(e=L.row)?void 0:e.contractId)||"")||1}),X=b(()=>{var e,l;return(null==(l=ae.getSymbolModel((null==(e=L.row)?void 0:e.contractId)||""))?void 0:l.lastPrice)||"0"}),j=b(()=>{var e,l;return new w((null==(e=L.row)?void 0:e.openValue)||0).div((null==(l=L.row)?void 0:l.openSize)||0)}),Y=b(()=>{var e;if(w(V.value||0).lte(0)||w(F.triggerPrice||0).lte(0))return"";const l=(null==(e=F.type)?void 0:e.includes("LIMIT"))?F.price:X.value;if(!l)return"";const t=w(F.triggerPrice||0).minus(l).times(V.value||0).abs().dp(2).toFixed();return w(F.triggerPrice||0).gte(l)&&U.value||w(F.triggerPrice||0).lte(l)&&!U.value?R("expectedProfitUSD",{n:t}):R("expectedLossUSD",{n:t})}),J=b(()=>{var e;if(w(V.value||0).lte(0)||w(N.triggerPrice||0).lte(0))return"";const l=(null==(e=N.type)?void 0:e.includes("LIMIT"))?N.price:X.value;if(!l)return"";const t=w(N.triggerPrice||0).minus(l).times(V.value||0).abs().dp(2).toFixed();return w(N.triggerPrice||0).lt(l)&&U.value||w(N.triggerPrice||0).gt(l)&&!U.value?R("expectedLossUSD",{n:t}):R("expectedProfitUSD",{n:t})}),K=(e,l=0)=>{1===l?M.tpPercent1=Math.min(Math.max(e,0),200):M.tpPercent=e,U.value?F.triggerPrice=new w(e||0).div(100).div(D.value).plus(1).times(j.value).dp(E.value,w.ROUND_FLOOR).toNumber():F.triggerPrice=new w(e||0).negated().div(100).div(D.value).plus(1).times(j.value).dp(E.value,w.ROUND_FLOOR).toNumber()};const q=(e,l=0)=>{1===l?M.slPercent1=Math.min(Math.max(e,0),200):M.slPercent=e,U.value?N.triggerPrice=new w(e||0).negated().div(100).div(D.value).plus(1).times(j.value).dp(E.value,w.ROUND_FLOOR).toNumber():N.triggerPrice=new w(e||0).div(100).div(D.value).plus(1).times(j.value).dp(E.value,w.ROUND_FLOOR).toNumber()};const W=n(!1),Q=b(()=>{var e,l;return!V.value||!(F.triggerPrice||N.triggerPrice)||(null==(e=F.type)?void 0:e.includes("LIMIT"))&&!F.price||(null==(l=N.type)?void 0:l.includes("LIMIT"))&&!N.price});function B(){return W.value=!0,Promise.all([H(),G()]).then(([e,t])=>{e&&t&&(l.value=!1)}).finally(()=>{W.value=!1})}function H(){const e=L.row;if(F.triggerPrice&&w(V.value||"0").gt(0)){const l={type:F.type,size:String(V.value||"0"),triggerPrice:F.triggerPrice.toString()||"0",price:String(F.price||"0"),side:U.value?"SELL":"BUY",contractId:(null==e?void 0:e.contractId)||"",reduceOnly:!0,isPositionTpsl:!0,isSetOpenTp:!1,isSetOpenSl:!1};return re(l).then(e=>(k({type:"success",message:R("setTakeProfitOrderSuccess")}),Promise.resolve(e))).catch(e=>(k({type:"error",message:null==e?void 0:e.message}),Promise.resolve(!1)))}return Promise.resolve(!0)}function G(){const e=L.row;if(N.triggerPrice&&w(V.value||"0").gt(0)){const l={type:N.type,size:String(V.value||"0"),triggerPrice:N.triggerPrice.toString()||"0",price:String(N.price||"0"),side:U.value?"SELL":"BUY",contractId:(null==e?void 0:e.contractId)||"",reduceOnly:!0,isPositionTpsl:!0,isSetOpenTp:!1,isSetOpenSl:!1};return re(l).then(e=>(k({type:"success",message:R("setStopLossOrderSuccess")}),Promise.resolve(e))).catch(e=>(k({type:"error",message:null==e?void 0:e.message}),Promise.resolve(!1)))}return Promise.resolve(!0)}return(t,a)=>{const r=ce,i=pe,o=ue,n=de,s=me,b=ve,k=xe,A=z,H=O,G=c("slider-active");return u(),d(H,{modelValue:l.value,"onUpdate:modelValue":a[23]||(a[23]=e=>l.value=e),"append-to-body":"",title:g(R)("takeProfitStopLoss2"),width:"500px","destroy-on-close":""},{default:p(()=>{var c,z,O,H,$,ee,le;return[m("div",ge,[m("div",be,[v(x(g(_)[(null==(c=L.row)?void 0:c.contractId)||""])+" ",1),m("div",{class:f(("getColorClass"in t?t.getColorClass:g(P))((null==(z=L.row)?void 0:z.openValue)||"0"))},x(g(w)((null==(O=L.row)?void 0:O.openValue)||0).gt(0)?g(R)("long"):g(R)("short"))+" "+x(g(D))+"X ",3)]),m("div",fe,[m("div",Pe,[m("label",we,x(g(R)("entryPrice")),1),v(" "+x(("formatNumber"in t?t.formatNumber:g(h))(g(j).toString(),{limit:6,decimals:g(E)})),1)]),m("div",he,[m("label",ye,x(g(R)("latestPrice")),1),v(" "+x(("formatNumber"in t?t.formatNumber:g(h))(g(X),{limit:20,decimals:g(E)})),1)])]),m("div",Se,x(g(R)("stopTips")),1),m("div",null,[y(n,{trigger:"click"},{dropdown:p(()=>[y(o,{class:"[--el-font-size-base:12px]"},{default:p(()=>[y(i,{onClick:a[0]||(a[0]=e=>g(F).type="TAKE_PROFIT_MARKET")},{default:p(()=>[v(x(g(R)("marketStop")),1)]),_:1}),y(i,{onClick:a[1]||(a[1]=e=>g(F).type="TAKE_PROFIT_LIMIT")},{default:p(()=>[v(x(g(R)("limitStop")),1)]),_:1})]),_:1})]),default:p(()=>[m("span",Ie,[m("span",null,x("TAKE_PROFIT_MARKET"===g(F).type?g(R)("marketStop"):g(R)("limitStop")),1),y(r)])]),_:1}),m("div",Te,[y(s,{modelValue:g(F).triggerPrice,"onUpdate:modelValue":a[2]||(a[2]=e=>g(F).triggerPrice=e),precision:g(E),controls:!1,align:"left",class:"flex-1",placeholder:g(R)("triggerPrice"),min:g(U)?Number(g(X)):void 0,max:g(U)?void 0:Number(g(X)),onChange:a[3]||(a[3]=e=>function(e){U.value?M.tpPercent=new w(e||0).minus(j.value).div(j.value).times(D.value).times(100).dp(0,w.ROUND_FLOOR).toNumber():M.tpPercent=new w(e||0).minus(j.value).negated().div(j.value).times(D.value).times(100).dp(0,w.ROUND_FLOOR).toNumber(),M.tpPercent1=Math.min(Math.max(M.tpPercent,0),200)}(e))},null,8,["modelValue","precision","placeholder","min","max"]),y(s,{modelValue:g(M).tpPercent,"onUpdate:modelValue":[a[4]||(a[4]=e=>g(M).tpPercent=e),a[5]||(a[5]=e=>K(e,1))],modelModifiers:{number:!0},precision:0,controls:!1,align:"left",class:"w-100px text-12px",placeholder:g(R)("returnRate")},{suffix:p(()=>[...a[24]||(a[24]=[v(" % ",-1)])]),_:1},8,["modelValue","placeholder"])]),S(y(b,{modelValue:g(M).tpPercent1,"onUpdate:modelValue":a[6]||(a[6]=e=>g(M).tpPercent1=e),min:0,max:200,step:1,marks:{0:"0%",50:"50%",100:"100%",150:"150%",200:"200%"},class:"mb-30px [&&]:[--el-slider-button-size:16px] [--el-color-white:--icon-color] [&&]:[--el-slider-height:2px] [&&]:[--el-slider-button-wrapper-offset:-17px] [&&]:h-auto [&&]:[w-auto] [--el-border-color-light:var(--dialog-divider)] [&&]:[--el-slider-main-bg-color:--main-text] ml-4px [&&]:w-456px",onChange:a[7]||(a[7]=e=>K(e))},null,8,["modelValue"]),[[G]]),"TAKE_PROFIT_LIMIT"===g(F).type?(u(),d(s,{key:0,modelValue:g(F).price,"onUpdate:modelValue":a[8]||(a[8]=e=>g(F).price=e),modelModifiers:{number:!0},controls:!1,align:"left",class:"text-12px [&&]:w-full",placeholder:g(R)("price")},null,8,["modelValue","placeholder"])):I("",!0),g(Y)?(u(),d(k,{key:1,style:{"--el-alert-title-font-size":"12px","--el-alert-padding":"5px 10px",margin:"10px 0"},title:g(Y),type:"success",closable:!1},null,8,["title"])):I("",!0),y(n,{trigger:"click"},{dropdown:p(()=>[y(o,{class:"[--el-font-size-base:12px]"},{default:p(()=>[y(i,{onClick:a[9]||(a[9]=e=>g(N).type="STOP_MARKET")},{default:p(()=>[v(x(g(R)("marketStop2")),1)]),_:1}),y(i,{onClick:a[10]||(a[10]=e=>g(N).type="STOP_LIMIT")},{default:p(()=>[v(x(g(R)("limitStop2")),1)]),_:1})]),_:1})]),default:p(()=>[m("span",ze,[m("span",null,x("STOP_MARKET"===g(N).type?g(R)("marketStop2"):g(R)("limitStop2")),1),y(r)])]),_:1}),m("div",Oe,[y(s,{modelValue:g(N).triggerPrice,"onUpdate:modelValue":a[11]||(a[11]=e=>g(N).triggerPrice=e),controls:!1,align:"left",class:"flex-1",placeholder:g(R)("triggerPrice"),min:g(U)?void 0:Number(g(X)),max:g(U)?Number(g(X)):void 0,onChange:a[12]||(a[12]=e=>function(e){U.value?M.slPercent=new w(e||0).minus(j.value).negated().div(j.value).times(D.value).times(100).dp(0,w.ROUND_FLOOR).toNumber():M.slPercent=new w(e||0).minus(j.value).div(j.value).times(D.value).times(100).dp(0,w.ROUND_FLOOR).toNumber(),M.slPercent1=Math.min(Math.max(M.slPercent,0),200)}(e))},null,8,["modelValue","placeholder","min","max"]),y(s,{modelValue:g(M).slPercent,"onUpdate:modelValue":[a[13]||(a[13]=e=>g(M).slPercent=e),a[14]||(a[14]=e=>q(e,1))],modelModifiers:{number:!0},controls:!1,align:"left",class:"w-100px text-12px",placeholder:g(R)("returnRate")},{prefix:p(()=>{var e;return[m("span",ke,x(g(w)((null==(e=g(M))?void 0:e.slPercent)||0).gt(0)?"-":""),1)]}),suffix:p(()=>[...a[25]||(a[25]=[v(" % ",-1)])]),_:1},8,["modelValue","placeholder"])]),S(y(b,{modelValue:g(M).slPercent1,"onUpdate:modelValue":a[15]||(a[15]=e=>g(M).slPercent1=e),min:0,max:200,step:1,marks:{0:"0%",50:"50%",100:"100%",150:"150%",200:"200%"},class:"mb-30px [&&]:[--el-slider-button-size:16px] [--el-color-white:--icon-color] [&&]:[--el-slider-height:2px] [&&]:[--el-slider-button-wrapper-offset:-17px] [&&]:h-auto [&&]:[w-auto] [--el-border-color-light:var(--dialog-divider)] [&&]:[--el-slider-main-bg-color:--main-text] ml-4px [&&]:w-456px",onChange:a[16]||(a[16]=e=>q(e))},null,8,["modelValue"]),[[G]]),"STOP_LIMIT"===g(N).type?(u(),d(s,{key:2,modelValue:g(N).price,"onUpdate:modelValue":a[17]||(a[17]=e=>g(N).price=e),modelModifiers:{number:!0},controls:!1,align:"left",class:"text-12px [&&]:w-full",placeholder:g(R)("price")},null,8,["modelValue","placeholder"])):I("",!0),g(J)?(u(),d(k,{key:3,style:{"--el-alert-title-font-size":"12px","--el-alert-padding":"5px 10px",margin:"10px 0"},title:g(J),type:"error",closable:!1},null,8,["title"])):I("",!0),m("div",Le,[y(s,{modelValue:g(V),"onUpdate:modelValue":a[18]||(a[18]=e=>T(V)?V.value=e:null),modelModifiers:{number:!0},precision:g(Z)<0?0:g(Z),step:g(Z)<0?10**-g(Z):1,"step-strictly":g(Z)<0,class:"[&&]:w-full",controls:!1,align:"left",placeholder:g(R)("orderQuantity"),max:Math.abs(Number((null==(H=e.row)?void 0:H.openSize)||"0")),onChange:a[19]||(a[19]=e=>function(e){var l;M.sizePercent=new w(e||0).times(100).div(new w((null==(l=L.row)?void 0:l.openSize)||"0").abs()).dp(0,w.ROUND_FLOOR).toNumber()}(e))},null,8,["modelValue","precision","step","step-strictly","placeholder","max"])]),S(y(b,{modelValue:g(M).sizePercent,"onUpdate:modelValue":a[20]||(a[20]=e=>g(M).sizePercent=e),min:0,max:100,step:1,marks:{0:"0%",25:"25%",50:"50%",75:"75%",100:"100%"},class:"[&&]:[--el-slider-button-size:16px] [--el-color-white:--icon-color] [&&]:[--el-slider-height:2px] [&&]:[--el-slider-button-wrapper-offset:-17px] [&&]:h-auto [&&]:[w-auto] [--el-border-color-light:var(--dialog-divider)] [&&]:[--el-slider-main-bg-color:--main-text] ml-4px [&&]:w-456px",onChange:a[21]||(a[21]=e=>(e=>{var l,t;Z.value<0?V.value=new w(e||0).div(100).times(new w((null==(l=L.row)?void 0:l.openSize)||"0").abs().times(new w(10).pow(Z.value))).dp(0,w.ROUND_FLOOR).div(new w(10).pow(Z.value)).toNumber():V.value=new w(e||0).div(100).times(new w((null==(t=L.row)?void 0:t.openSize)||"0").abs()).dp(Z.value,w.ROUND_FLOOR).toNumber()})(e))},null,8,["modelValue"]),[[G]]),m("div",Ae,[m("span",Ce,x(g(R)("positionQty")),1),m("span",null,x(Math.abs(Number((null==($=L.row)?void 0:$.openSize)||"0")))+" "+x(g(_)[(null==(ee=L.row)?void 0:ee.contractId)||""].replace("USD","")),1)]),m("div",Re,[m("span",Ve,x(g(R)("orderQuantity")),1),m("span",null,x(g(V)||"0.0")+" "+x(g(_)[(null==(le=L.row)?void 0:le.contractId)||""].replace("USD","")),1)]),m("div",Me,[y(A,{class:"h-40px flex-1 m-l-auto",color:g(C).isDark?"#333":"#F2F2F2",onClick:a[22]||(a[22]=e=>l.value=!1)},{default:p(()=>[v(x(t.$t("cancel")),1)]),_:1},8,["color"]),y(A,{type:"primary",class:"h-40px flex-1 m-l-auto",disabled:g(Q),loading:g(W),onClick:B},{default:p(()=>[v(x(t.$t("confirm")),1)]),_:1},8,["disabled","loading"])])])])]}),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-36cd1535"]]),Ne={key:0,class:"color-[--down-color]"},Ue={key:1,class:"color-[--up-color]"},_e={class:"mt-20px flex justify-end"},Ee=e({__name:"stopTable",props:{orderList:{},orderListModifiers:{},visible:{type:Boolean},visibleModifiers:{}},emits:l(["add"],["update:orderList","update:visible"]),setup(e,{emit:l}){const o=a(),n=r(),s=t(e,"orderList"),c=l,f=t(e,"visible"),{t:P}=i(),w={LAST_PRICE:P("latestPrice"),TAKE_PROFIT_LIMIT:P("takeProfitLimit"),LIMIT:P("limit"),MARKET:P("market"),STOP_LIMIT:P("stop_limit"),STOP_MARKET:P("stop_market"),TAKE_PROFIT_MARKET:P("takeProfitMarket")},S=b(()=>{var e,l,t;const a=(null==(t=null==(l=null==(e=o.metadata)?void 0:e.contractList)?void 0:l.reduce)?void 0:t.call(l,(e,l)=>(e[l.contractId]=l.contractName,e),{}))||{};return a.ALL=P("all"),a}),T=async e=>{V.confirm(P("botCancelOrder"),P("cancelOrder"),{confirmButtonText:P("confirm"),cancelButtonText:P("cancel"),type:"warning"}).then(async()=>{var l,t,a,r;const i=e?[e]:(null==(t=null==(l=null==s?void 0:s.value)?void 0:l.map)?void 0:t.call(l,e=>e.id))||[];await M(i),F.success(P("cancelledOrderSuccessfully")),s.value=(null==(r=null==(a=s.value)?void 0:a.filter)?void 0:r.call(a,e=>!i.includes(e.id)))||[]})};return(e,l)=>{const t=$,a=R,r=G,i=z,o=O;return u(),d(o,{modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=e=>f.value=e),"append-to-body":"",title:g(P)("stopLimit"),width:"800px","destroy-on-close":""},{default:p(()=>{var o;return[y(r,{data:null==(o=s.value)?void 0:o.toSorted((e,l)=>((null==l?void 0:l.createdTime)||0)-((null==e?void 0:e.createdTime)||0)),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px",fit:""},{default:p(()=>[y(t,{width:"50",label:g(P)("No"),type:"index"},null,8,["label"]),y(t,{align:"right",label:g(P)("orderType"),prop:"orderType"},{default:p(({row:l})=>[l.type.includes("STOP")?(u(),A("span",Ne,x(e.$t("stopLoss")),1)):l.type.includes("PROFIT")?(u(),A("span",Ue,x(e.$t("takeProfit")),1)):I("",!0)]),_:1},8,["label"]),y(t,{align:"right",label:g(P)("orderSize"),prop:"size"},{default:p(({row:l})=>[v(x(("formatNumber"in e?e.formatNumber:g(h))(l.size,10))+" "+x(g(S)[l.contractId].replace("USD","")),1)]),_:1},8,["label"]),y(t,{"min-width":"150",align:"right",label:g(P)("triggerPrice"),prop:"triggerPrice"},{default:p(({row:l})=>[v(x(l.triggerSign)+x(("formatNumber"in e?e.formatNumber:g(h))(l.triggerPrice,{limit:20,decimals:10}))+" "+x(w[l.triggerPriceType]),1)]),_:1},8,["label"]),y(t,{align:"right",label:g(P)("price"),prop:"price"},{default:p(({row:l})=>[v(x(l.type.includes("LIMIT")?("formatNumber"in e?e.formatNumber:g(h))(l.price,{decimals:10,limit:20}):g(P)("market")),1)]),_:1},8,["label"]),y(t,{"min-width":"150",align:"right",label:g(P)("orderTime"),prop:"createdTime"},{default:p(({row:e})=>[v(x(g(C)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),y(t,{width:100,align:"right",label:g(P)("action"),prop:"operate"},{default:p(({row:e})=>[y(a,{name:"custom:delete",class:"w-14px h-14px color-[--third-text] cursor-pointer",onClick:l=>T(e.id)},null,8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),m("div",_e,[y(i,{class:"m-l-auto [&&]:w-88px",color:g(n).isDark?"#333":"#F2F2F2",onClick:l[0]||(l[0]=e=>c("add"))},{default:p(()=>[v(x(e.$t("add")),1)]),_:1},8,["color"]),y(i,{type:"primary",class:"m-l-auto [&&]:w-88px",onClick:l[1]||(l[1]=e=>T())},{default:p(()=>[v(x(e.$t("cancelAll")),1)]),_:1})])]}),_:1},8,["modelValue","title"])}}}),Ze={class:"flex items-center font-bold h-21px mb-16px"},De={class:"flex items-center justify-between mb-16px"},Xe={class:"color-[--third-text]"},je={class:"color-[--main-text]"},Ye={class:"color-[--third-text] mb-8px"},Je={class:"color-[--third-text] justify-between mb-8px"},Ke={class:"color-[--third-text] flex justify-between mt-38px mb-8px"},qe={class:"flex mt-20px text-16px"},We=L(e({__name:"closePosition",props:l({row:{},token:{}},{visible:{type:Boolean},visibleModifiers:{}}),emits:["update:visible"],setup(e){const l=e,a=r(),L=t(e,"visible"),{t:C}=i(),R=s({closePrice:void 0,closeSize:void 0});o(L,e=>{e&&(R.closePrice=j.value,R.closeSize=w(X.value||"0").abs().times(new w(10).pow(E.value)).dp(0,w.ROUND_FLOOR).div(new w(10).pow(E.value)).toNumber(),V.value=100)});const V=n(0),M=b(()=>"limit"===l.row.operation),F=b(()=>M.value?C("limitClose"):C("marketClose")),_=b(()=>ee(l.row.contractId||"")),E=b(()=>le(l.row.contractId||"")),Z=b(()=>ae.getSymbolModel(l.row.contractId)),D=b(()=>te(l.row.contractId)||"1"),X=b(()=>l.row.openSize||"0"),j=b(()=>{var e;return(null==(e=Z.value)?void 0:e.lastPrice)||"0"});const Y=b(()=>{const e=l.row,t=(M.value?R.closePrice:j.value)||"0";if(!e||new w(t).isZero())return"0";return(Number(null==e?void 0:e.openSize)>=0?new w(t).times(new w((null==e?void 0:e.openSize)||0).abs()).minus(new w(e.openValue).abs()):new w(e.openValue||0).abs().minus(new w(t).times(new w(e.openSize).abs()))).dp(2,w.ROUND_FLOOR)}),J=n(!1),K=b(()=>new w(R.closeSize||0).isZero()||M.value&&new w(R.closePrice||0).isZero());function q(){const e=l.row;if(R.closePrice&&w(R.closeSize||"0").gt(0)){const l={type:M.value?"LIMIT":"MARKET",size:String(R.closeSize||"0"),price:String(R.closePrice||"0"),side:w((null==e?void 0:e.openSize)||"0").gte(0)?"SELL":"BUY",contractId:(null==e?void 0:e.contractId)||"",reduceOnly:!0,isPositionTpsl:!1,isSetOpenTp:!1,isSetOpenSl:!1};J.value=!0,re(l).then(e=>{k({type:"success",message:M.value?C("limitPriceClosePosition"):C("closePositionSubmitted")}),L.value=!1}).catch(e=>{k({type:"error",message:null==e?void 0:e.message})}).finally(()=>{J.value=!1})}}return(t,r)=>{const i=me,o=ve,n=z,s=O,b=c("slider-active");return u(),d(s,{modelValue:L.value,"onUpdate:modelValue":r[7]||(r[7]=e=>L.value=e),"append-to-body":"",title:g(F),width:"450px","destroy-on-close":""},{default:p(()=>{var s;return[m("div",Ze,[v(x(l.token)+" · "+x(g(C)("all2")),1),m("span",{class:f(["ml-4px font-normal",("getColorClass"in t?t.getColorClass:g(P))(l.row.openValue)])},x(g(w)(l.row.openValue||0).gt(0)?g(C)("long"):g(C)("short"))+" · "+x(g(D))+"X ",3)]),m("div",De,[m("span",Xe,x(g(C)("latestPrice")),1),m("span",je,x(("formatNumber"in t?t.formatNumber:g(h))(g(j),{limit:20,decimals:g(_)}))+" USD",1)]),g(M)?(u(),A(N,{key:0},[m("div",Ye,x(g(C)("closePrice")),1),y(i,{modelValue:g(R).closePrice,"onUpdate:modelValue":r[1]||(r[1]=e=>g(R).closePrice=e),precision:g(_),align:"left",controls:!1,min:0,class:"mb-16px w-full!"},{suffix:p(()=>[r[8]||(r[8]=m("span",{class:"color-[--third-text] mx-4px"},"|",-1)),m("span",{class:"color-[--up-color] clickable",onClick:r[0]||(r[0]=U(e=>g(R).closePrice=g(j),["stop"]))},x(g(C)("midPrice")),1)]),_:1},8,["modelValue","precision"])],64)):I("",!0),m("div",Je,x(g(C)("closeSize")),1),y(i,{modelValue:g(R).closeSize,"onUpdate:modelValue":r[2]||(r[2]=e=>g(R).closeSize=e),precision:g(E)<0?0:g(E),step:g(E)<0?10**-g(E):1,"step-strictly":g(E)<0,align:"left",controls:!1,class:"mb-12px w-full!",max:Math.abs(Number((null==(s=e.row)?void 0:s.openSize)||"0")),onChange:r[3]||(r[3]=e=>function(e){var t;V.value=new w(e||0).times(100).div(new w((null==(t=l.row)?void 0:t.openSize)||"0").abs()).dp(0,w.ROUND_FLOOR).toNumber()}(e))},null,8,["modelValue","precision","step","step-strictly","max"]),S(y(o,{modelValue:g(V),"onUpdate:modelValue":r[4]||(r[4]=e=>T(V)?V.value=e:null),min:0,max:100,step:1,marks:{0:"0%",25:"25%",50:"50%",75:"75%",100:"100%"},class:"[&&]:[--el-slider-button-size:16px] [--el-color-white:--icon-color] [&&]:[--el-slider-height:2px] [&&]:[--el-slider-button-wrapper-offset:-17px] [&&]:h-auto [&&]:[w-auto] [--el-border-color-light:var(--dialog-divider)] [&&]:[--el-slider-main-bg-color:--main-text] ml-4px [&&]:w-406px",onInput:r[5]||(r[5]=e=>(e=>{var t;R.closeSize=new w(e||0).div(100).times(new w((null==(t=l.row)?void 0:t.openSize)||"0").abs()).dp(E.value,w.ROUND_FLOOR).toNumber()})(e))},null,8,["modelValue"]),[[b]]),m("div",Ke,[v(x(g(C)("estimatedPL"))+" ",1),m("span",{class:f(g(w)(g(Y)).gte(0)?"color-[--up-color]":"color-[--down-color]")},x(g(Y))+" USD",3)]),m("div",qe,[y(n,{class:"h-40px flex-1 m-l-auto",color:g(a).isDark?"#333":"#F2F2F2",onClick:r[6]||(r[6]=U(e=>L.value=!1,["stop"]))},{default:p(()=>[v(x(t.$t("cancel")),1)]),_:1},8,["color"]),y(n,{type:"primary",class:"h-40px flex-1 m-l-auto",disabled:g(K),loading:g(J),onClick:U(q,["stop"])},{default:p(()=>[v(x(t.$t("confirm")),1)]),_:1},8,["disabled","loading"])])]}),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-d904563a"]]),Qe=""+new URL("perp-up.CTvO_BsM.png",import.meta.url).href,Be=""+new URL("perp-down.lIyTNwtK.png",import.meta.url).href,He={class:"flex justify-between items-center mb-40px"},Ge={class:"flex items-center gap-12px mb-30px"},$e=["src"],el={class:"flex flex-col gap-4px"},ll={class:"text-20px"},tl={class:"flex items-center gap-4px"},al={class:"px-4px py-1px rounded-4px text-10px bg-[--primary-color]"},rl={class:"mb-66px"},il={key:0,class:"flex items-center lh-22px mb-3px"},ol={class:"text-[--third-text]"},nl={key:1,class:"flex items-center lh-22px"},sl={class:"text-[--third-text]"},cl={class:"flex items-center gap-30px mt-16px"},dl=["onClick"],ul={__name:"share",props:{statistics:{type:Object,default:()=>({})}},setup(e){const{t:l}=i(),t=e,a=_("shareDom"),r=n(!1),o=n(C().format("YYYY/MM/DD HH:mm:ss")),s=n([{get label(){return l("profit6")},value:"unrealizedPnl",checked:!0,icon:"perp-share1",get disabled(){var e;return!(null==(e=s.value.find(e=>"unrealizedPnlRate"===e.value))?void 0:e.checked)}},{get label(){return"% "+l("RIO")},value:"unrealizedPnlRate",checked:!0,get disabled(){var e;return!(null==(e=s.value.find(e=>"unrealizedPnl"===e.value))?void 0:e.checked)}},{get label(){return l("leverage")},value:"leverage",checked:!0,icon:"perp-share3"},{get label(){return l("time")},value:"time",checked:!0,icon:"perp-share4"}]),c=b(()=>t.statistics.unrealizedPnl>0?Qe:Be),w=e=>{var l;return null==(l=s.value.find(l=>l.value===e))?void 0:l.checked};return(e,i)=>{const n=R,b=O;return u(),A(N,null,[y(n,{class:"color-[--third-text] cursor-pointer shrink-0",name:"ic:outline-share",onClick:i[0]||(i[0]=e=>r.value=!0)}),y(b,{modelValue:g(r),"onUpdate:modelValue":i[1]||(i[1]=e=>T(r)?r.value=e:null),"header-class":"share-header",title:g(l)("sharePosition"),width:"810","append-to-body":"",class:"[&.el-dialog]:[--el-dialog-padding-primary:40px]"},{default:p(()=>[m("div",{ref_key:"shareDom",ref:a,class:"relative py-30px px-42px bg-cover mt--15px",style:E(`background-image: url(${g(c)})`)},[m("div",He,[i[2]||(i[2]=m("img",{height:"32",src:"data:image/png;base64,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",alt:""},null,-1)),w("time")?(u(),A(N,{key:0},[v(x(g(o)),1)],64)):I("",!0)]),m("div",Ge,[m("img",{class:"w-60px h-60px rounded-full",src:t.statistics.logo_url,alt:""},null,8,$e),m("div",el,[m("strong",ll,x(t.statistics.name),1),m("div",tl,[m("span",{class:f([t.statistics.openValue>0?"bg-[--up-color]":"bg-[--down-color]","px-4px py-1px rounded-4px text-10px"])},x(t.statistics.openValue>0?g(l)("long"):g(l)("short")),3),m("span",al,[v(x(g(l)("all2")),1),w("leverage")?(u(),A(N,{key:0},[v(x(t.statistics.leverage)+"x",1)],64)):I("",!0)])])])]),m("div",rl,[w("unrealizedPnl")?(u(),A("div",{key:0,class:f([("getColorClass"in e?e.getColorClass:g(P))(t.statistics.unrealizedPnl),"text-24px font-bold text-60px font-800 lh-72px"])},x(("addSign"in e?e.addSign:g(Z))(t.statistics.unrealizedPnl))+"$"+x(("formatNumber"in e?e.formatNumber:g(h))(Math.abs(t.statistics.unrealizedPnl),{decimals:2,limit:20})),3)):I("",!0),w("unrealizedPnlRate")?(u(),A("div",{key:1,class:f([("getColorClass"in e?e.getColorClass:g(P))(t.statistics.unrealizedPnl),w("unrealizedPnl")?"text-24px":"text-60px font-800"])},x(("addSign"in e?e.addSign:g(Z))(t.statistics.unrealizedPnlRate))+x(("formatNumber"in e?e.formatNumber:g(h))(Math.abs(t.statistics.unrealizedPnlRate),2))+"% ",3)):I("",!0)]),m("div",null,[t.statistics.entryPrice?(u(),A("div",il,[m("span",null,[m("span",ol,x(g(l)("openPrice2"))+": ",1),v("$"+x(t.statistics.entryPrice),1)])])):I("",!0),t.statistics.closePrice?(u(),A("div",nl,[m("span",null,[m("span",sl,x(g(l)("closePrice2"))+": ",1),v("$"+x(t.statistics.closePrice),1)])])):I("",!0)])],4),m("div",cl,[(u(!0),A(N,null,D(g(s),e=>(u(),A("span",{key:e.value,class:f(["flex-1 h-32px cursor-pointer items-center rounded-8px text-center lh-30px border-1px border-solid",e.checked?"color-[--main-text] border-[--main-text]":"color-[--secondary-text] bg-[--border] border-transparent",e.disabled?"cursor-not-allowed":"cursor-pointer"]),onClick:l=>(e=>{e.disabled||(e.checked=!e.checked)})(e)},[e.icon?(u(),d(n,{key:0,class:"text-12px color-[--main-text]",name:`custom:${e.icon}`},null,8,["name"])):I("",!0),v(" "+x(e.label),1)],10,dl))),128))])]),_:1},8,["modelValue","title"])],64)}}},pl={class:"relative min-h-400px bg-[--secondary-bg]"},ml={class:"text-12px"},vl={key:1},xl={class:"flex items-center text-14px lh-18px color-[--main-text] gap-4px mb-4px"},gl={key:0,class:"flex items-center gap-2px [&>span]:bg-[#3b3b3b] data-[active=on]:[&>span:nth-child(1)]:bg-[#08BA4E] data-[active=on]:[&>span:nth-child(2)]:bg-[#409F4B] data-[active=on]:[&>span:nth-child(3)]:bg-[#7F8147] data-[active=on]:[&>span:nth-child(4)]:bg-[#B36844] data-[active=on]:[&>span:nth-child(5)]:bg-[#F1493F]"},bl=["data-active"],fl={class:"text-12px lh-18px flex flex-col gap-4px"},Pl={class:"flex items-center justify-end gap-4px"},wl={__name:"holding",props:{searchParams:{type:Object,default:()=>({})}},setup(e){const l=e;let t={id:null};const{t:r}=i(),s=a(),O=X(),k=q({}),L=n(!1),C=n(null),R=n(!1),V=n(!1),M=b(()=>{var e,l,t;const a=(null==(t=null==(l=null==(e=s.metadata)?void 0:e.contractList)?void 0:l.reduce)?void 0:t.call(l,(e,l)=>(e[l.contractId]=l.contractName,e),{}))||{};return a.ALL=r("all"),a}),F=b(()=>{var e;const t=null==(e=s.position)?void 0:e.filter(e=>{var t,a,r;return(null==(t=null==l?void 0:l.searchParams)?void 0:t.filterContractIdList)&&e.contractId===(null==(a=null==l?void 0:l.searchParams)?void 0:a.filterContractIdList)||!(null==(r=l.searchParams)?void 0:r.filterContractIdList)}),a=null==t?void 0:t.find(e=>e.contractId===s.perp.contractId);return a?[a].concat((t||[]).filter(e=>e.contractId!==s.perp.contractId)):t||[]});o(()=>O.wsResult[j.TICKER_ALL_1S],e=>{s.position.forEach(l=>{var t,a,r;const i=null==(a=null==(t=e.data)?void 0:t.find)?void 0:a.call(t,e=>e.contractId===l.contractId);if(i){l.oraclePrice=i.oraclePrice;const e=(null==i?void 0:i.lastPrice)||(null==i?void 0:i.oraclePrice)||"0",t=Number(null==l?void 0:l.openSize)>=0?new w(e).times(new w((null==l?void 0:l.openSize)||0).abs()).minus(new w(l.openValue).abs()):new w(l.openValue||0).abs().minus(new w(e).times(new w(l.openSize).abs()));l.unrealizedPnl=t.dp(2,w.ROUND_FLOOR).toString(),l.unrealizedPnlRate=null==(r=ie(l.contractId))?void 0:r.unrealizedPnlRoe}})}),o(()=>{var e;return null==(e=s.totalAssets)?void 0:e.accountList},e=>{var l;if(e){const t=(null==(l=null==e?void 0:e[0])?void 0:l.positionAssetList)||[];s.position.forEach(e=>{const l=t.find(l=>l.contractId===e.contractId);l&&(e.maxLeverage=l.maxLeverage,e.liquidatePrice=l.liquidatePrice)})}},{immediate:!0});const U=async()=>{const e=await Q();k.value=(null==e?void 0:e.positionContractIdToLightNumberMap)||{}},_=b(()=>{var e,l,t,a,r;return(null==(e=C.value)?void 0:e.contractId)?null==(r=null==(a=(null==(t=null==(l=s.order)?void 0:l.filter)?void 0:t.call(l,e=>{var l;return e.contractId===(null==(l=C.value)?void 0:l.contractId)&&["TAKE_PROFIT_LIMIT","STOP_LIMIT","TAKE_PROFIT_MARKET","STOP_MARKET"].includes(e.type)}))||[])?void 0:a.toSorted)?void 0:r.call(a,(e,l)=>l.createdTime-e.createdTime):[]}),E=(e,l)=>{V.value=!0,C.value={...e,operation:l}},B=()=>{R.value=!1,L.value=!0};Y(()=>{O.send({type:"unsubscribe",channel:"ticker.all.1s"}),setTimeout(()=>{O.send({type:"subscribe",channel:"ticker.all.1s"})},500),U(),t=J(5e3,()=>{U()})}),K(()=>{t.id&&cancelAnimationFrame(t.id)});const H=(e,l,t)=>h(new w(l).div(t).toString(),{limit:20,decimals:ee(e),decimalsHasZero:!0});return(e,l)=>{var t;const a=W,i=$,o=z,n=G,b=c("tooltip");return u(),A(N,null,[m("div",pl,[y(n,{fit:"",data:g(F),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:p(()=>{var l;return[0===(null==(l=g(s).position)?void 0:l.length)?(u(),d(a,{key:0,class:"pt-[40px]"},{default:p(()=>[m("span",ml,x(e.$t("emptyNoData")),1)]),_:1})):(u(),A("span",vl))]}),default:p(()=>[y(i,{label:g(r)("markets1"),prop:"perp"},{default:p(({row:l})=>[m("div",xl,[v(x(g(M)[l.contractId])+" ",1),"number"==typeof g(k)[l.contractId]?S((u(),A("div",gl,[(u(),A(N,null,D(5,e=>m("span",{key:e,class:"w-2px h-10px","data-active":g(k)[l.contractId]>e?"on":"off"},null,8,bl)),64))])),[[b,g(r)("autoDeleverageTips")]]):I("",!0)]),m("div",{class:f(["text-10px lh-14px",("getColorClass"in e?e.getColorClass:g(P))(l.openValue)])},x(l.openValue>0?g(r)("long"):g(r)("short"))+" "+x(g(te)(l.contractId)||l.maxLeverage)+"x ",3)]),_:1},8,["label"]),y(i,{width:100,label:g(r)("Qty"),prop:"openSize"},{default:p(({row:l})=>[v(x(("formatNumber"in e?e.formatNumber:g(h))(l.openSize.replace("-",""))),1)]),_:1},8,["label"]),y(i,{align:"right",label:g(r)("contractValue"),prop:"openValue"},{default:p(({row:l})=>[v(x(("formatNumber"in e?e.formatNumber:g(h))(l.oraclePrice?new(g(w))(l.openSize).multipliedBy(l.oraclePrice).toString().replace("-",""):l.openValue.replace("-",""),{limit:20,decimals:4})),1)]),_:1},8,["label"]),y(i,{align:"right",label:g(r)("entryPrice"),prop:"entryPrice"},{default:p(({row:e})=>[v(x(H(e.contractId,e.openValue,e.openSize)),1)]),_:1},8,["label"]),y(i,{align:"right",label:g(r)("oraclePrice"),prop:"oraclePrice"},{default:p(({row:l})=>[v(x(("formatNumber"in e?e.formatNumber:g(h))(l.oraclePrice,{limit:20,decimals:("getPricePrecision"in e?e.getPricePrecision:g(ee))(l.contractId),decimalsHasZero:!0})),1)]),_:1},8,["label"]),y(i,{align:"right",label:g(r)("estimatedLiquidationPrice"),prop:"liquidatePrice"},{default:p(({row:l})=>[v(x(("formatNumber"in e?e.formatNumber:g(h))(("getPositionLiqPrice"in e?e.getPositionLiqPrice:g(oe))(l.contractId)||l.liquidatePrice,{limit:20,decimals:("getPricePrecision"in e?e.getPricePrecision:g(ee))(l.contractId),decimalsHasZero:!0})),1)]),_:1},8,["label"]),y(i,{align:"right",label:g(r)("unrealizedPnl"),prop:"unrealizedPnl"},{default:p(({row:l})=>{var t,a,r;return[m("div",fl,[m("span",{class:f(("getColorClass"in e?e.getColorClass:g(P))(l.unrealizedPnl))},x(("addSign"in e?e.addSign:g(Z))(l.unrealizedPnl))+x(("formatNumber"in e?e.formatNumber:g(h))(Math.abs(l.unrealizedPnl),2)),3),m("span",Pl,[m("span",{class:f(("getColorClass"in e?e.getColorClass:g(P))(l.unrealizedPnlRate))},"("+x(("addSign"in e?e.addSign:g(Z))(l.unrealizedPnlRate))+x(("formatNumber"in e?e.formatNumber:g(h))(Math.abs(l.unrealizedPnlRate),2))+"%)",3),y(ul,{statistics:{leverage:g(te)(l.contractId)||l.maxLeverage,openValue:l.openValue,entryPrice:H(l.contractId,l.openValue,l.openSize),unrealizedPnl:l.unrealizedPnl,unrealizedPnlRate:l.unrealizedPnlRate,name:null==(a=null==(t=g(M)[l.contractId])?void 0:t.replace)?void 0:a.call(t,"USD",""),logo_url:null==(r=g(s).contractList.find(e=>e.contractId===l.contractId))?void 0:r.baseCoinIcon}},null,8,["statistics"])])])]}),_:1},8,["label"]),y(i,{align:"right",label:g(r)("fundingFee"),prop:"fundingFee"},{default:p(({row:l})=>[v(x(("formatNumber"in e?e.formatNumber:g(h))(l.fundingFee,("getPricePrecision"in e?e.getPricePrecision:g(ee))(l.contractId))),1)]),_:1},8,["label"]),y(i,{width:150,align:"right",label:g(r)("takeProfitStopLoss"),prop:"takeProfitStopLoss"},{default:p(({row:l})=>{var t,a;return[(null==(a=null==(t=g(s).order)?void 0:t.some)?void 0:a.call(t,e=>(null==e?void 0:e.contractId)===(null==l?void 0:l.contractId)))?(u(),d(o,{key:0,size:"small",style:{"--el-button-active-border-color":"transparent"},onClick:e=>(e=>{C.value=e,R.value=!0})(l)},{default:p(()=>[v(x(e.$t("detail")),1)]),_:1},8,["onClick"])):I("",!0),y(o,{size:"small",style:{"--el-button-active-border-color":"transparent"},onClick:e=>(e=>{C.value=e,L.value=!0})(l)},{default:p(()=>[v(" + "+x(e.$t("add")),1)]),_:1},8,["onClick"])]}),_:1},8,["label"]),y(i,{width:150,align:"right",label:g(r)("action"),prop:"closePosition"},{default:p(({row:l})=>[y(o,{size:"small",style:{"--el-button-active-border-color":"transparent"},onClick:e=>E(l,"limit")},{default:p(()=>[v(x(e.$t("limit")),1)]),_:1},8,["onClick"]),y(o,{size:"small",style:{"--el-button-active-border-color":"transparent"},onClick:e=>E(l,"market")},{default:p(()=>[v(x(e.$t("market")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),y(Fe,{visible:g(L),"onUpdate:visible":l[0]||(l[0]=e=>T(L)?L.value=e:null),row:g(C)},null,8,["visible","row"]),y(Ee,{visible:g(R),"onUpdate:visible":l[1]||(l[1]=e=>T(R)?R.value=e:null),orderList:g(_),onAdd:B},null,8,["visible","orderList"]),y(We,{visible:g(V),"onUpdate:visible":l[2]||(l[2]=e=>T(V)?V.value=e:null),token:g(M)[null==(t=g(C))?void 0:t.contractId]||"",row:g(C)||{}},null,8,["visible","token","row"])],64)}}},hl={class:"flex items-center justify-center w-[calc(100vw-100px)]"},yl={class:"text-12px mr-10px"},Sl=e({__name:"withdrawAlert",setup(e){const l=a(),{t:t}=i(),{isCanNormalWithdrawableAmount:r}=ne();function o(){B().then(e=>{l.normalWithdrawableAmount=(null==e?void 0:e.amount)||"0"}).catch(e=>{l.normalWithdrawableAmount="0"})}const s=n(!1);function c(){s.value=!0,se().then(e=>e.wait()).then(e=>{o(),k({type:"success",message:t("claimedSuccess")})}).catch(e=>{H(e)}).finally(()=>{s.value=!1})}return Y(()=>{o()}),(e,t)=>{const a=z,i=xe;return g(r)?(u(),d(i,{key:0,type:"success",closable:!1,style:{"--el-alert-icon-large-size":"20px"}},{default:p(()=>[m("div",hl,[m("span",yl,x(e.$t("canPerpWithdraw",{n:("formatNumber"in e?e.formatNumber:g(h))(g(l).normalWithdrawableAmount,3)})),1),y(a,{type:"primary",size:"small",loading:g(s),onClick:c},{default:p(()=>[v(x(e.$t("claim")),1)]),_:1},8,["loading"])])]),_:1})):I("",!0)}}});export{wl as _,Sl as a,ul as b};

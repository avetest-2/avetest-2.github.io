import{aW as e,G as t,gv as n,gw as o,cC as r,E as i,ay as l,F as a,D as s,gx as u,n as c,az as f,cB as v}from"./pxHhHUe5.js";const h="undefined"!=typeof window&&"undefined"!=typeof document;function d(n,o=!0,i){r()?e(n,i):o?n():t(n)}"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const p=h?window:void 0;function g(e){var t;const n=u(e);return null!=(t=null==n?void 0:n.$el)?t:n}function w(){const t=l(!1),n=r();return n&&e(()=>{t.value=!0},n),t}function y(e){const t=w();return i(()=>(t.value,Boolean(e())))}function b(e,t,r={}){const{window:l=p,...a}=r;let c;const f=y(()=>l&&"ResizeObserver"in l),v=()=>{c&&(c.disconnect(),c=void 0)},h=i(()=>{const t=u(e);return Array.isArray(t)?t.map(e=>g(e)):[g(t)]}),d=s(h,e=>{if(v(),f.value&&l){c=new ResizeObserver(t);for(const t of e)t&&c.observe(t,a)}},{immediate:!0,flush:"post"}),w=()=>{v(),d()};var b;return b=w,n()&&o(b),{isSupported:f,stop:w}}function m(e,t={width:0,height:0},n={}){const{window:o=p,box:r="content-box"}=n,a=i(()=>{var t,n;return null==(n=null==(t=g(e))?void 0:t.namespaceURI)?void 0:n.includes("svg")}),u=l(t.width),c=l(t.height),{stop:f}=b(e,([t])=>{const n="border-box"===r?t.borderBoxSize:"content-box"===r?t.contentBoxSize:t.devicePixelContentBoxSize;if(o&&a.value){const t=g(e);if(t){const e=t.getBoundingClientRect();u.value=e.width,c.value=e.height}}else if(n){const e=(i=n,Array.isArray(i)?i:[i]);u.value=e.reduce((e,{inlineSize:t})=>e+t,0),c.value=e.reduce((e,{blockSize:t})=>e+t,0)}else u.value=t.contentRect.width,c.value=t.contentRect.height;var i},n);d(()=>{const n=g(e);n&&(u.value="offsetWidth"in n?n.offsetWidth:t.width,c.value="offsetHeight"in n?n.offsetHeight:t.height)});const v=s(()=>g(e),e=>{u.value=e?t.width:0,c.value=e?t.height:0});return{width:u,height:c,stop:function(){f(),v()}}}function x(e,t){const{containerStyle:n,wrapperProps:o,scrollTo:r,calculateRange:l,currentList:a,containerRef:s}="itemHeight"in t?function(e,t){const n=R(t),{state:o,source:r,currentList:l,size:a,containerRef:s}=n,u={overflowY:"auto"},{itemHeight:c,overscan:f=5}=e,v=z(o,r,c),h=S(r,c),d=L("vertical",f,h,v,n),p=T(c,r),g=i(()=>p(o.value.start)),w=W(c,r);P(a,t,s,d);const y=B("vertical",d,p,s),b=i(()=>({style:{width:"100%",height:w.value-g.value+"px",marginTop:`${g.value}px`}}));return{calculateRange:d,scrollTo:y,containerStyle:u,wrapperProps:b,currentList:l,containerRef:s}}(t,e):function(e,t){const n=R(t),{state:o,source:r,currentList:l,size:a,containerRef:s}=n,u={overflowX:"auto"},{itemWidth:c,overscan:f=5}=e,v=z(o,r,c),h=S(r,c),d=L("horizontal",f,h,v,n),p=T(c,r),g=i(()=>p(o.value.start)),w=W(c,r);P(a,t,s,d);const y=B("horizontal",d,p,s),b=i(()=>({style:{height:"100%",width:w.value-g.value+"px",marginLeft:`${g.value}px`,display:"flex"}}));return{scrollTo:y,calculateRange:d,wrapperProps:b,containerStyle:u,currentList:l,containerRef:s}}(t,e);return{list:a,scrollTo:r,containerProps:{ref:s,onScroll:()=>{l()},style:n},wrapperProps:o}}function R(e){const t=l(null),n=m(t),o=a([]),r=l(e);return{state:a({start:0,end:10}),source:r,currentList:o,size:n,containerRef:t}}function z(e,t,n){return o=>{if("number"==typeof n)return Math.ceil(o/n);const{start:r=0}=e.value;let i=0,l=0;for(let e=r;e<t.value.length;e++){if(i+=n(e),l=e,i>o)break}return l-r}}function S(e,t){return n=>{if("number"==typeof t)return Math.floor(n/t)+1;let o=0,r=0;for(let i=0;i<e.value.length;i++){if(o+=t(i),o>=n){r=i;break}}return r+1}}function L(e,t,n,o,{containerRef:r,state:i,currentList:l,source:a}){return()=>{const s=r.value;if(s){const r=n("vertical"===e?s.scrollTop:s.scrollLeft),u=o("vertical"===e?s.clientHeight:s.clientWidth),c=r-t,f=r+u+t;i.value={start:c<0?0:c,end:f>a.value.length?a.value.length:f},l.value=a.value.slice(i.value.start,i.value.end).map((e,t)=>({data:e,index:t+i.value.start}))}}}function T(e,t){return n=>{if("number"==typeof e){return n*e}return t.value.slice(0,n).reduce((t,n,o)=>t+e(o),0)}}function P(e,t,n,o){s([e.width,e.height,()=>u(t),n],()=>{o()})}function W(e,t){return i(()=>"number"==typeof e?t.value.length*e:t.value.reduce((t,n,o)=>t+e(o),0))}const A={horizontal:"scrollLeft",vertical:"scrollTop"};function B(e,t,n,o){return r=>{o.value&&(o.value[A[e]]=n(r),t())}}const k=c({name:"UseVirtualList",props:["list","options","height"],setup(e,{slots:t,expose:n}){const{list:o}=f(e),{list:r,containerProps:i,wrapperProps:l,scrollTo:a}=x(o,e.options);return n({scrollTo:a}),i.style&&"object"==typeof i.style&&!Array.isArray(i.style)&&(i.style.height=e.height||"300px"),()=>v("div",{...i},[v("div",{...l.value},r.value.map(e=>v("div",{style:{overflow:"hidden",height:e.height}},t.default?t.default(e):"Please set content!")))])}});export{k as U};

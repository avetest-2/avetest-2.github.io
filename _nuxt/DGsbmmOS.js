import{n as e,au as l,go as a,aA as t,av as i,D as r,F as s,ay as o,a7 as d,c as n,o as c,M as u,b as m,fm as p,J as f,a as b,w as v,H as y,S as g,t as h,E as x,d as w,a8 as _,a5 as T,K as P,aa as I,aq as N,aQ as k,T as E,ax as L,aP as A,cD as O,qu as D,qt as F}from"./pxHhHUe5.js";import{E as M,a as Y}from"./DlhmlHT6.js";import"./xG3n2otq.js";import"./uG3PizZo.js";import"./DU6RBO19.js";const R=["infinite-scroll-disabled"],K={class:"text-12px"},S={key:1},C={class:"text-14px"},j={class:"flex items-center justify-end gap-4px"},z={class:"flex items-center justify-end gap-4px"},H={class:"text-12px"},U={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},B={key:0},V={class:"flex items-center justify-start gap-4px"},q=e({__name:"historyOrder",props:{searchParams:{}},setup(e){const q=l(),Q=a(),J=t(),{t:W}=i(),Z=e,$=o([]),G=s({loading:!1,finished:!1,error:!1}),X=s(""),ee=s(!1),le=s({title:"",list:[]}),ae={LAST_PRICE:W("latestPrice"),TAKE_PROFIT_LIMIT:W("takeProfitLimit")},te={CANCELED:W("cancelled1"),FILLED:W("filled")},ie=x(()=>{var e,l,a;const t=(null==(a=null==(l=null==(e=Q.metadata)?void 0:e.contractList)?void 0:l.reduce)?void 0:a.call(l,(e,l)=>(e[l.contractId]=l.contractName,e),{}))||{};return t.ALL=W("all"),t}),re=async()=>{if(G.value.loading||G.value.finished)return;const e={filterStatusList:"FILLED,CANCELED",...Z.searchParams};X.value&&(e.offsetData=X.value);try{G.value.loading=!0;const l=await D(e);let a=l.dataList||[];X.value&&(a=$.value.concat(a)),l.nextPageOffsetData||(G.value.finished=!0),X.value=l.nextPageOffsetData,$.value=a}catch(l){G.value.error=!0}finally{G.value.loading=!1}};q.address&&re();return r(()=>[Z.searchParams,q.address],()=>{X.value="",$.value=[],G.value.finished=!1,G.value.error=!1,G.value.loading=!1,re()}),(e,l)=>{const a=L,t=M,i=I,r=k,s=E,o=Y,x=O,D=d("copy"),q=p;return c(),n(T,null,[u((c(),n("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":f(G).loading||f(G).finished||f(G).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[m(o,{fit:"",data:f($),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:v(()=>{var l;return[f(G).loading||0!==(null==(l=f($))?void 0:l.length)?(c(),n("span",S)):(c(),y(a,{key:0,class:"pt-[40px]"},{default:v(()=>[b("span",K,h(e.$t("emptyNoData")),1)]),_:1}))]}),default:v(()=>[m(t,{label:f(W)("markets1"),prop:"contractId"},{default:v(({row:e})=>[b("span",C,h(f(ie)[e.contractId]),1)]),_:1},8,["label"]),m(t,{label:f(W)("tradeVolume"),prop:"contractSize"},{default:v(({row:l})=>[w(h(("formatNumber"in e?e.formatNumber:f(_))(l.cumMatchSize,3))+"/"+h(("formatNumber"in e?e.formatNumber:f(_))(l.l2Size,3)),1)]),_:1},8,["label"]),m(t,{minWidth:100,align:"right",label:f(W)("price"),prop:"fillPrice"},{default:v(({row:l})=>{var a,t;return[w(h((null==(t=null==(a=l.type)?void 0:a.includes)?void 0:t.call(a,"MARKET"))?f(W)("market"):("formatNumber"in e?e.formatNumber:f(_))(l.price,{limit:20,decimals:10})),1)]}),_:1},8,["label"]),m(t,{align:"right",label:f(W)("triggerPrice"),prop:"triggerPrice"},{default:v(({row:l})=>{var a,t,i,r,s,o,d,u;return[(null==(t=null==(a=l.type)?void 0:a.includes)?void 0:t.call(a,"STOP"))||(null==(r=null==(i=l.type)?void 0:i.includes)?void 0:r.call(i,"TAKE_PROFIT"))?(c(),n(T,{key:1},["BUY"===l.side?(c(),n(T,{key:0},[w(h((null==(o=null==(s=l.type)?void 0:s.includes)?void 0:o.call(s,"TAKE_PROFIT"))?"≤":"≥"),1)],64)):(c(),n(T,{key:1},[w(h((null==(u=null==(d=l.type)?void 0:d.includes)?void 0:u.call(d,"TAKE_PROFIT"))?"≥":"≤"),1)],64)),w(" "+h(("formatNumber"in e?e.formatNumber:f(_))(l.triggerPrice,10))+" "+h(ae[l.triggerPriceType]),1)],64)):(c(),n(T,{key:0},[w(" -- ")],64))]}),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:f(W)("tradeType"),prop:"side"},{default:v(({row:e})=>[b("span",{class:P("BUY"===e.side?"color-[--up-color]":"color-[--down-color]")},h("BUY"===e.side?f(W)("buy"):f(W)("sell")),3)]),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:f(W)("orderType"),prop:"orderType"},{default:v(({row:e})=>{var l,a,t,i;return[e.type.includes("TAKE_PROFIT")?(c(),n(T,{key:0},[w(h(f(W)("takeProfit")),1)],64)):e.type.includes("STOP")?(c(),n(T,{key:1},[w(h(f(W)("stopLoss")),1)],64)):(c(),n(T,{key:2},[w(h((null==(a=null==(l=e.type)?void 0:l.includes)?void 0:a.call(l,"MARKET"))?f(W)("market"):"")+h((null==(i=null==(t=e.type)?void 0:t.includes)?void 0:i.call(t,"LIMIT"))?f(W)("limit"):""),1)],64))]}),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:f(W)("filledType"),prop:"tradeType2"},{default:v(({row:e})=>[w(h(f(W)("trades")),1)]),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:f(W)("status"),prop:"status"},{default:v(({row:e})=>[w(h(te[e.status]),1)]),_:1},8,["label"]),m(t,{align:"right",label:f(W)("orderId"),prop:"orderId"},{default:v(({row:e})=>[b("div",j,[w(h(e.id.slice(0,4))+"..."+h(e.id.slice(-4)),1),u(m(i,{name:"bxs:copy",class:"color-[#5A5E64]"},null,512),[[D,e.id]])])]),_:1},8,["label"]),m(t,{align:"right",label:f(W)("orderTime"),prop:"createdTime"},{default:v(({row:e})=>[w(h(f(N)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:f(W)("onlyReduce"),prop:"reduceOnly"},{default:v(({row:e})=>[w(h(e.reduceOnly?f(W)("yes"):f(W)("no")),1)]),_:1},8,["label"]),"perp-id"!==f(J).name?(c(),y(t,{key:0,align:"right",label:f(W)("executionStrategy"),prop:"reduceOnly"},{default:v(({row:e})=>{var l,a;return[b("div",z,[w(h((null==(a=null==(l=e.type)?void 0:l.includes)?void 0:a.call(l,"MARKET"))?f(W)("immediateOrCancel"):f(W)("validityPeriod2"))+" ",1),m(r,{width:200},{reference:v(()=>[m(i,{name:"custom:info"})]),default:v(()=>{var l,a;return[b("span",H,h((null==(a=null==(l=e.type)?void 0:l.includes)?void 0:a.call(l,"MARKET"))?f(W)("immediateOrCancel2"):f(W)("validityPeriod3")),1)]}),_:2},1024)])]}),_:1},8,["label"])):g("",!0),m(t,{"min-width":80,align:"right",label:f(W)("action")},{default:v(({row:e})=>[m(s,{style:{"--el-button-active-border-color":"transparent"},size:"small",onClick:l=>(async e=>{ee.value=!0,le.value.title=ie.value[e.contractId]+"-"+("BUY"===e.side?W("buy"):W("sell"));const l=await F({size:10,filterOrderIdList:e.id});le.value.list=l.dataList})(e)},{default:v(()=>[w(h(f(W)("detail")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),b("div",U,[f(G).loading&&f(X)?(c(),n("span",B,h(f(W)("loading")),1)):g("",!0)])],8,R)),[[q,re]]),m(x,{modelValue:f(ee),"onUpdate:modelValue":l[0]||(l[0]=e=>A(ee)?ee.value=e:null),title:f(le).title,width:"700","append-to-body":"","destroy-on-close":""},{default:v(()=>[m(o,{fit:"","header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px",data:f(le).list},{default:v(()=>[m(t,{label:f(W)("filledQty")},{default:v(({row:l})=>[w(h(("formatNumber"in e?e.formatNumber:f(_))(l.fillSize,{limit:20,decimals:10})),1)]),_:1},8,["label"]),m(t,{label:f(W)("filledPrice")},{default:v(({row:l})=>[w(h(("formatNumber"in e?e.formatNumber:f(_))(l.fillPrice,{limit:20,decimals:10})),1)]),_:1},8,["label"]),m(t,{label:f(W)("role")},{default:v(({row:e})=>[w(h(e.direction),1)]),_:1},8,["label"]),m(t,{label:f(W)("fee")},{default:v(({row:l})=>[w(h(("formatNumber"in e?e.formatNumber:f(_))(l.fillFee,{limit:20})),1)]),_:1},8,["label"]),m(t,{label:f(W)("tradeNo"),"min-width":"150"},{default:v(({row:e})=>[b("div",V,[w(h(e.matchFillId.slice(0,4))+"..."+h(e.matchFillId.slice(-4))+" ",1),u(m(i,{name:"bxs:copy",class:"color-[#5A5E64]"},null,512),[[D,e.matchFillId]])])]),_:1},8,["label"]),m(t,{width:150,label:f(W)("tradeTime")},{default:v(({row:e})=>[w(h(f(N)(Number(e.createdTime)).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["modelValue","title"])],64)}}});export{q as default};

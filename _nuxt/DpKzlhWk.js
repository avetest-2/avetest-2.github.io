import{a as e,E as a}from"./BC28JpVo.js";import{E as l}from"./C4ZtUdxm.js";import{n as t,go as i,av as r,F as n,aq as o,c as s,o as d,a as u,M as c,b as m,w as f,a5 as p,a6 as v,J as b,E as g,H as x,t as h,d as T,fm as E,K as y,a8 as w,qx as C,ay as I,ax as S,S as N,qv as L}from"./pxHhHUe5.js";import{E as _,a as j}from"./DlhmlHT6.js";import"./xG3n2otq.js";import"./uG3PizZo.js";import{S as D}from"./EKWuchHU.js";import"./Ss6PgMLe.js";import"./liJ_O3Tw.js";import"./BwPtREp8.js";import"./DU6RBO19.js";const z={class:"flex items-center justify-end gap-8px mb-16px"},Y={class:"flex items-center gap-4px text-12px"},P=["infinite-scroll-disabled"],V={class:"text-12px"},k={key:1},F={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},M={key:0},O=t({__name:"fundingRate",setup(t){const O=i(),{t:U}=r(),A=I([]),R=n({loading:!1,finished:!1,error:!1}),$=n(""),q=n({filterTypeList:"SETTLE_FUNDING_FEE",filterContractIdList:"ALL",filterStartCreatedTimeInclusive:o().subtract(7,"d").startOf("day").unix(),filterEndCreatedTimeExclusive:o().endOf("day").unix()}),H=g(()=>{var e,a,l;const t=(null==(l=null==(a=null==(e=O.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,(e,a)=>(e[a.contractId]=a.contractName,e),{}))||{};return t.ALL=U("all"),t}),X=g(()=>{var e,a,l;const t=null==(l=null==(a=null==(e=O.metadata)?void 0:e.contractList)?void 0:a.map)?void 0:l.call(a,e=>({label:e.contractName,value:e.contractId}));return[{label:U("all"),value:"ALL"}].concat(t||[])}),B=e=>!!q.value.filterEndCreatedTimeExclusive&&o(e).isAfter(o(1e3*Number(q.value.filterEndCreatedTimeExclusive))),G=e=>!!q.value.filterStartCreatedTimeInclusive&&o(e).isBefore(o(1e3*Number(q.value.filterStartCreatedTimeInclusive))),J=async()=>{if(R.value.loading||R.value.finished)return;const e=Object.create(null);Object.keys(q.value).forEach(a=>{const l=q.value[a];l&&(["filterStartCreatedTimeInclusive","filterEndCreatedTimeExclusive"].includes(a)?e[a]=1e3*l:"ALL"!==l&&(e[a]=l))}),$.value&&(e.offsetData=$.value);try{R.value.loading=!0;const a=await L(e);let l=a.dataList||[];$.value&&(l=A.value.concat(l)),a.nextPageOffsetData||(R.value.finished=!0),$.value=a.nextPageOffsetData,A.value=l}catch(a){R.value.error=!0}finally{R.value.loading=!1}};J();const K=()=>{$.value="",A.value=[],R.value.finished=!1,R.value.error=!1,R.value.loading=!1,J()};return(t,i)=>{const r=e,n=a,g=l,I=S,L=_,O=j,Z=E;return d(),s(p,null,[u("div",z,[m(n,{modelValue:b(q).filterContractIdList,"onUpdate:modelValue":i[0]||(i[0]=e=>b(q).filterContractIdList=e),size:"small",class:"[&&]:[--el-select-width:110px]","popper-class":"[--el-font-size-base:12px]","suffix-icon":b(D),persistent:!1,onChange:K},{prefix:f(()=>[u("span",null,h(b(U)("markets1")),1)]),default:f(()=>[(d(!0),s(p,null,v(b(X),e=>(d(),x(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","suffix-icon"]),u("div",Y,[m(g,{modelValue:b(q).filterStartCreatedTimeInclusive,"onUpdate:modelValue":i[1]||(i[1]=e=>b(q).filterStartCreatedTimeInclusive=e),size:"small","disabled-date":B,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:b(U)("startTime"),"value-format":"X",teleported:!1,clearable:!1,onChange:K},null,8,["modelValue","placeholder"]),T(" "+h(t.$t("to"))+" ",1),m(g,{modelValue:b(q).filterEndCreatedTimeExclusive,"onUpdate:modelValue":i[2]||(i[2]=e=>b(q).filterEndCreatedTimeExclusive=e),size:"small","disabled-date":G,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:b(U)("endTime1"),"value-format":"X",teleported:!1,clearable:!1,onChange:K},null,8,["modelValue","placeholder"])])]),c((d(),s("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":b(R).loading||b(R).finished||b(R).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[m(O,{data:b(A),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:f(()=>{var e;return[b(R).loading||0!==(null==(e=b(A))?void 0:e.length)?(d(),s("span",k)):(d(),x(I,{key:0,class:"pt-[40px]"},{default:f(()=>[u("span",V,h(t.$t("emptyNoData")),1)]),_:1}))]}),default:f(()=>[m(L,{label:b(U)("tradeTime"),prop:"fundingTime"},{default:f(({row:e})=>[T(h(b(o)(+e.fundingTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),m(L,{label:b(U)("markets1"),prop:"contractId"},{default:f(({row:e})=>[T(h(b(H)[e.contractId]),1)]),_:1},8,["label"]),m(L,{width:100,align:"right",label:b(U)("direction"),prop:"direction"},{default:f(({row:e})=>[u("span",{class:y(e.fundingPositionSize>0?"color-[--up-color]":"color-[--down-color]")},h(e.fundingPositionSize>0?b(U)("long"):b(U)("short")),3)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("contractSize"),prop:"contractSize"},{default:f(({row:e})=>{var a,l;return[T(h(("formatNumber"in t?t.formatNumber:b(w))(new(b(C))(e.fundingPositionSize).abs().toString()))+h(null==(l=null==(a=b(H)[e.contractId])?void 0:a.replace)?void 0:l.call(a,"USD","")),1)]}),_:1},8,["label"]),m(L,{align:"right",label:b(U)("fundingFee"),prop:"deltaFundingFee"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(w))(new(b(C))(e.deltaFundingFee).abs().toString()))+"USD ",1)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("fundingRate"),prop:"fundingRate"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(w))(100*Math.abs(e.fundingRate)))+"% ",1)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("oraclePrice"),prop:"fundingOraclePrice"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(w))(e.fundingOraclePrice,{limit:20,decimals:2})),1)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("indexPrice"),prop:"fundingIndexPrice"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(w))(e.fundingIndexPrice,{limit:20,decimals:2})),1)]),_:1},8,["label"])]),_:1},8,["data"]),u("div",F,[b(R).loading&&b($)?(d(),s("span",M,h(b(U)("loading")),1)):N("",!0)])],8,P)),[[Z,J]])],64)}}});export{O as default};

import{n as e,a3 as a,a2 as l,av as t,ai as o,at as s,au as i,d0 as r,D as n,oR as d,F as p,nB as u,ay as c,dL as m,ac as v,E as h,aW as f,H as b,o as x,w as g,am as _,b as w,J as y,c as k,a5 as $,a6 as N,a as V,S as j,aa as C,al as W,cN as T,t as O,K as P,ov as F,W as A,N as H,e1 as z,M as D,fm as L,bZ as M,b_ as S,aP as B,cD as E,bV as R,bW as U,a8 as Z,_ as I}from"./pxHhHUe5.js";import{a as J,E as K}from"./DlhmlHT6.js";import"./xG3n2otq.js";import"./uG3PizZo.js";import{_ as q}from"./R6PXlxGf.js";import"./DU6RBO19.js";import"./BeXmGP7f.js";const G={key:0,class:"flex flex-col items-center justify-center py-30px"},Q={key:0,src:M},X={key:1,src:S},Y={key:1},ee={key:0,class:"flex items-center text-right justify-end"},ae={key:1},le={key:0,class:"flex items-center clickable flex-nowrap relative"},te={class:"whitespace-nowrap text-ellipsis overflow-hidden max-w-90px mr-8px"},oe={key:4,class:"pr-10px inline-block"},se=["infinite-scroll-disabled"],ie={key:0,class:"text-center px-0 pt-15px pb-10px text-12px color-[--third-text]"},re={key:1,class:"text-center px-0 pt-15px pb-10px text-12px color-[--third-text]"},ne=I(e({__name:"positionsTable",props:{modelValue:Boolean,tableFilter:{type:Object,default:()=>({hide_risk:1,hide_small:0,user_ids:[]})}},emits:["update:modelValue","hideToken"],setup(e,{emit:M}){const{mode:S}=a(l()),{t:I}=t(),ne=o(),de=s(),pe=i(),{updateHolderNum:ue}=a(r()),ce=h(()=>[{label:I("token"),prop:"token",align:"left",sortable:!1,minWidth:125,showOverflowTooltip:!0},{label:I("balance1"),prop:"balance_usd",align:"right",sortable:!1,formatter:e=>`$${Z(e.balance_usd,4)}`},{label:I("amount"),prop:"balance",align:"right",sortable:!1,formatter:e=>`${Z(e.balance,4)}`},{label:I("costPrice"),prop:"average_purchase_price_usd",align:"right",sortable:!1,formatter:e=>`$${Z(e.average_purchase_price_usd,4)}`},{label:I("currentPrice"),prop:"current_price_usd",align:"right",sortable:!1,formatter:e=>`$${Z(e.current_price_usd,4)}`},{label:"PnL",prop:"total_profit_ratio",width:100,align:"right",sortable:!1,getClassName:e=>Number(e.total_profit_ratio)>0?`color-${R[0]}`:`color-${U[0]}`,formatter:e=>`${Number(e.total_profit_ratio)>0?"+":"-"}${Z(Math.abs(100*Number(e.total_profit_ratio)),2)}%`}]),me=c([]),ve=e,he=M,fe=p(!1),be=p({}),xe=p({...d}),ge=h({get:()=>ve.modelValue,set:e=>he("update:modelValue",e)}),_e=h(()=>{var e;return"solana"!==(null==(e=be.value)?void 0:e.chain)?de.evmAddress||pe.address:de.getWalletAddress("solana")||pe.address});function we(e){ne.push({name:"token-id",params:{id:null==e?void 0:e.index}}),ge.value=!1}n(()=>ue.value,()=>{xe.value={...d},ye()});const ye=async()=>{if(xe.value.loaded)return;xe.value.loaded=!0;const e=xe.value.pageNO,a=xe.value.pageSize;u({pageNO:e,pageSize:a,...ve.tableFilter}).then(l=>{var t,o;const s=(null==l?void 0:l.data)||[];Array.isArray(s)&&(null==s?void 0:s.length)>0?(me.value=1===e?null==s?void 0:s.map(e=>{var a;return{...e,index:e.token===m?(null==(a=v(e.chain))?void 0:a.wmain_wrapper)+"-"+e.chain:`${e.token}-${e.chain}`}}):[...me.value].concat(null==(o=null==(t=s.filter)?void 0:t.call(s,e=>{var a,l;return null==(l=null==(a=me.value)?void 0:a.every)?void 0:l.call(a,a=>a.index!==`${e.token}-${e.chain}`)}))?void 0:o.map(e=>{var a;return{...e,index:e.token===m?(null==(a=v(e.chain))?void 0:a.wmain_wrapper)+"-"+e.chain:`${e.token}-${e.chain}`}})),xe.value.finished=(null==s?void 0:s.length)<a,xe.value.finished||xe.value.pageNO++):(1===e&&(me.value=[]),xe.value.finished=!0)}).finally(()=>{setTimeout(()=>{xe.value.loaded=!1},200)})};return n(ve.tableFilter,()=>{xe.value={...d},ye()}),n(()=>ge.value,e=>{e&&(xe.value={...d},ye())},{immediate:!0}),f(()=>{}),(e,a)=>{const l=H,t=A,o=C,s=F,i=K,r=J,n=E,d=L;return x(),b(n,{modelValue:y(ge),"onUpdate:modelValue":a[1]||(a[1]=e=>B(ge)?ge.value=e:null),class:"dialog-position",title:e.$t("myPosition1"),width:"680","append-to-body":"","destroy-on-close":""},{default:g(()=>[_(e.$slots,"default",{},void 0,!0),w(r,{class:"table-position w-100%",data:y(me),height:400,onRowClick:we,"row-class-name":"group"},{empty:g(()=>[y(xe).loaded?(x(),k("span",Y)):(x(),k("div",G,["light"===y(S)?(x(),k("img",Q)):j("",!0),"dark"===y(S)?(x(),k("img",X)):j("",!0),V("span",null,O(y(I)("emptyNoData")),1)]))]),append:g(()=>{var a,l;return[D(V("div",{class:"text-0 lh-0 h-0","infinite-scroll-disabled":y(xe).loaded||y(xe).finished,"infinite-scroll-distance":20,"infinite-scroll-delay":200,"infinite-scroll-immediate":!0},null,8,se),[[d,ye]]),y(xe).loaded&&(null==(a=y(me))?void 0:a.length)>0?(x(),k("div",ie,O(e.$t("loading")),1)):y(xe).finished&&(null==(l=y(me))?void 0:l.length)>0?(x(),k("div",re,O(e.$t("noMore")),1)):j("",!0)]}),default:g(()=>[(x(!0),k($,null,N(y(ce),a=>(x(),b(i,{key:a.prop,label:a.label,width:a.width,prop:a.prop,"min-width":null==a?void 0:a.minWidth,align:a.align,"show-overflow-tooltip":(null==a?void 0:a.showOverflowTooltip)||!1},{header:g(({column:a})=>["total_profit_ratio"==a.property?(x(),k("div",ee,[V("span",null,O(a.label),1),w(t,{effect:y(S),placement:"top-end",content:e.$t("PnLTips"),"popper-class":"[&&]:[--el-text-color-primary:--dialog-list-hover]!",persistent:!1},{default:g(()=>[w(l,{style:{cursor:"pointer","font-size":"14px","margin-left":"2px"}},{default:g(()=>[w(y(z))]),_:1})]),_:1},8,["effect","content"])])):(x(),k("div",ae,O(a.label),1))]),default:g(({row:e})=>[V("div",null,["token"===(null==a?void 0:a.prop)?(x(),k("div",le,["WatchWallet"!==y(pe).walletName?(x(),b(o,{key:0,name:"bx:bxs-hide",class:"bxs-hide cursor-pointer color-#959a9f overflow-hidden whitespace-nowrap max-w-0 group-hover:max-w-[100px] transition-all duration-500 ease-in-out",onClick:W(a=>function(e){fe.value=!0,be.value=e}(e),["self","stop"])},null,8,["onClick"])):j("",!0),w(T,{row:e,class:"w-24px h-24px mr-8px"},null,8,["row"]),V("div",te,O(null==e?void 0:e.symbol),1),e.risk_score>55||e.risk_level<0?(x(),b(o,{key:1,name:"custom:danger",class:"font-14 ml-2px color-#F72121 w-14px h-14px mt-2px"})):j("",!0)])):"--"===e[a.prop]?(x(),k("span",{key:1,class:P((null==a?void 0:a.getClassName)?a.getClassName(e):"")},"--",2)):0===e[a.prop]?(x(),k("span",{key:2,class:P((null==a?void 0:a.getClassName)?a.getClassName(e):"")},"0",2)):(x(),k("span",{key:3,class:P((null==a?void 0:a.getClassName)?a.getClassName(e):"")},O(a.formatter?a.formatter(e):e[a.prop]),3)),"total_profit_ratio"===(null==a?void 0:a.prop)?(x(),k("div",oe,[w(s,{address:e.address,statistics:e,chain:e.chain,type:"topHolder"},null,8,["address","statistics","chain"])])):j("",!0)])]),_:2},1032,["label","width","prop","min-width","align","show-overflow-tooltip"]))),128))]),_:1},8,["data"]),w(q,{modelValue:y(fe),"onUpdate:modelValue":a[0]||(a[0]=e=>B(fe)?fe.value=e:null),row:y(be),self_address:y(_e),onHideToken:()=>{}},null,8,["modelValue","row","self_address"])]),_:3},8,["modelValue","title"])}}}),[["__scopeId","data-v-d50bfe6d"]]);export{ne as default};
